<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<meta name="author" content="Roland HuÃŸ">
<title>fabric8io/docker-maven-plugin</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>fabric8io/docker-maven-plugin</h1>
<div class="details">
<span id="author" class="author">Roland HuÃŸ</span><br>
<span id="revnumber">version 0.15-SNAPSHOT,</span>
<span id="revdate">2016-07-23</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">docker-maven-plugin</div>
<ul class="sectlevel1">
<li><a href="#introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#building-images">1.1. Building Images</a></li>
<li><a href="#running-containers">1.2. Running Containers</a></li>
<li><a href="#configuration">1.3. Configuration</a></li>
<li><a href="#example">1.4. Example</a></li>
<li><a href="#features">1.5. Features</a></li>
</ul>
</li>
<li><a href="#installation">2. Installation</a></li>
<li><a href="#global-configuration">3. Global configuration</a></li>
<li><a href="#image-configuration">4. Image configuration</a></li>
<li><a href="#maven-goals">5. Maven Goals</a>
<ul class="sectlevel2">
<li><a href="#docker:build">5.1. <strong>docker:build</strong></a>
<ul class="sectlevel3">
<li><a href="#build-configuration">5.1.1. Configuration</a></li>
<li><a href="#build-assembly">5.1.2. Assembly</a></li>
<li><a href="#misc-startup">5.1.3. Startup Arguments</a></li>
<li><a href="#build-buildargs">5.1.4. Build Args</a></li>
</ul>
</li>
<li><a href="#docker:start">5.2. <strong>docker:start</strong></a>
<ul class="sectlevel3">
<li><a href="#start-configuration">5.2.1. Configuration</a></li>
<li><a href="#misc-env">5.2.2. Environment and Labels</a></li>
<li><a href="#start-port-mapping">5.2.3. Port Mapping</a></li>
<li><a href="#start-links">5.2.4. Network Links</a></li>
<li><a href="#start-restart">5.2.5. Restart Policy</a></li>
<li><a href="#start-volumes">5.2.6. Volumes</a></li>
<li><a href="#start-wait">5.2.7. Wait</a></li>
<li><a href="#start-logging">5.2.8. Logging</a></li>
</ul>
</li>
<li><a href="#docker:stop">5.3. <strong>docker:stop</strong></a></li>
<li><a href="#docker:push">5.4. <strong>docker:push</strong></a></li>
<li><a href="#docker:watch">5.5. <strong>docker:watch</strong></a></li>
<li><a href="#docker:remove">5.6. <strong>docker:remove</strong></a></li>
<li><a href="#docker:logs">5.7. <strong>docker:logs</strong></a></li>
<li><a href="#docker:source">5.8. <strong>docker:source</strong></a></li>
</ul>
</li>
<li><a href="#external-configuration">6. External Configuration</a>
<ul class="sectlevel2">
<li><a href="#property-configuration">6.1. Property based configuration</a></li>
</ul>
</li>
<li><a href="#registry">7. Registry handling</a></li>
<li><a href="#authentication">8. Authentication</a>
<ul class="sectlevel2">
<li><a href="#pull-vs-push-authentication">8.1. Pull vs. Push Authentication</a></li>
<li><a href="#openshift-authentication">8.2. OpenShift Authentication</a></li>
<li><a href="#password-encryption">8.3. Password encryption</a></li>
</ul>
</li>
<li><a href="#further-reading">9. Further reading</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>&#169; 2015 - 2016 The original authors.</p>
</div>
<!-- toc disabled -->
</div>
</div>
<div class="sect1">
<h2 id="introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is a Maven plugin for managing Docker images and containers. It focuses on two major aspects for a Docker build integration:</p>
</div>
<div class="sect2">
<h3 id="building-images">1.1. Building Images</h3>
<div class="paragraph">
<p>One purpose of this plugin is to create Docker images holding the actual application. This is done with the <a href="#docker:build"><strong>docker:build</strong></a> goal. It is easy to include build artifacts and their dependencies into an image. Therefore, this plugin uses the assembly descriptor format from the maven-assembly-plugin to specify the content which will be added from a sub-directory in the image (<code>/maven</code> by default). Images that are built with this plugin can be pushed to public or private Docker registries with <a href="#docker:push"><strong>docker:push</strong></a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="running-containers">1.2. Running Containers</h3>
<div class="paragraph">
<p>With this plugin it is possible to run completely isolated integration tests so you don&#8217;t need to take care of shared resources. Ports can be mapped dynamically and made available as Maven properties to your integration test code.</p>
</div>
<div class="paragraph">
<p>Multiple containers can be managed at once, which can be linked together or share data via volumes. Containers are created and started with the <a href="#docker:start"><strong>docker:start</strong></a> goal and stopped and destroyed with the <a href="#docker:stop"><strong>docker:stop</strong></a> goal. For integration tests both goals are typically bound to the the pre-integration-test and post-integration-test phase, respectively. It is recommended to use the maven-failsafe-plugin for integration testing in order to stop the docker container even when the tests fail.</p>
</div>
<div class="paragraph">
<p>For proper isolation, container exposed ports can be dynamically and flexibly mapped to local host ports. It is easy to specify a Maven property which will be filled in with a dynamically assigned port after a container has been started. This can then be used as parameter for integration tests to connect to the application.</p>
</div>
</div>
<div class="sect2">
<h3 id="configuration">1.3. Configuration</h3>
<div class="paragraph">
<p>The plugin configuration contains a global part and a list of image-specific configuration within a <code>&lt;images&gt;</code> list, where each image is defined within a <code>&lt;image&gt;</code> tag. See <a href="#example">below</a> for an example.</p>
</div>
<div class="paragraph">
<p>The <a href="#global-configuration">global part</a> contains configuration applicable to all images like the Docker URL or the path to the SSL certificates for communication with the Docker Host.</p>
</div>
<div class="paragraph">
<p>Then, each specific image configuration has three parts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A general image part containing the image name and alias.</p>
</li>
<li>
<p>A <a href="#docker:build">&lt;build&gt;</a> configuration specifying how images are built</p>
</li>
<li>
<p>A <a href="#docker:start">&lt;run&gt;</a> configuration describing how containers should be created and started.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>&lt;build&gt;</code> and <code>&lt;run&gt;</code> parts are optional and can be omitted.</p>
</div>
</div>
<div class="sect2">
<h3 id="example">1.4. Example</h3>
<div class="paragraph">
<p>In the following examples two images are specified. One is the official PostgreSQL 9 image from Docker Hub, which internally is referenced with an alias "database". It only has a <a href="#docker:start">&lt;run&gt;</a> section which declares that the startup should wait until the given text pattern is matched in the log output. Next is a "service" image, which has a <a href="#docker:build">&lt;build&gt;</a> section. It creates an image which has artifacts and dependencies in the <code>/maven</code> directory (and which are specified with an assembly descriptor). Additionally it specifies the startup command for the container, which in this example fires up a microservice from a jar file copied over via the assembly descriptor. It also exposes port 8080. In the <code>&lt;run&gt;</code> section this port is mapped to a dynamically chosen port, and then assigned to the Maven property <code>${tomcat.port}</code>. This property could be used, for example, by an integration test to access this microservice. An important part is the <code>&lt;links&gt;</code> section which indicates that the image with the alias of "database" is linked into the "service" container, which can access the internal ports in the usual Docker way (via environment variables prefixed with <code>DB_</code>).</p>
</div>
<div class="paragraph">
<p>Images can be specified in any order and the plugin will take care of the proper startup order (and will bail out if it detects circular dependencies).</p>
</div>
<div class="listingblock">
<div class="title">Example plugin configuration</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;configuration&gt;</span>
  <span class="tag">&lt;images&gt;</span>
    <span class="tag">&lt;image&gt;</span>
      <span class="tag">&lt;alias&gt;</span>service<span class="tag">&lt;/alias&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
      <span class="tag">&lt;name&gt;</span>fabric8/docker-demo:${project.version}<span class="tag">&lt;/name&gt;</span>

      <span class="tag">&lt;build&gt;</span> <i class="conum" data-value="2"></i><b>(2)</b>
         <span class="tag">&lt;from&gt;</span>java:8<span class="tag">&lt;/from&gt;</span> <i class="conum" data-value="3"></i><b>(3)</b>
         <span class="tag">&lt;assembly&gt;</span>
           <span class="tag">&lt;descriptor&gt;</span>docker-assembly.xml<span class="tag">&lt;/descriptor&gt;</span> <i class="conum" data-value="4"></i><b>(4)</b>
         <span class="tag">&lt;/assembly&gt;</span>
         <span class="tag">&lt;cmd&gt;</span> <i class="conum" data-value="5"></i><b>(5)</b>
            <span class="tag">&lt;shell&gt;</span>java -jar /maven/service.jar<span class="tag">&lt;/shell&gt;</span>
         <span class="tag">&lt;/cmd&gt;</span>
      <span class="tag">&lt;/build&gt;</span>

      <span class="tag">&lt;run&gt;</span> <i class="conum" data-value="6"></i><b>(6)</b>
         <span class="tag">&lt;ports&gt;</span> <i class="conum" data-value="7"></i><b>(7)</b>
           <span class="tag">&lt;port&gt;</span>tomcat.port:8080<span class="tag">&lt;/port&gt;</span>
         <span class="tag">&lt;/ports&gt;</span>
         <span class="tag">&lt;wait&gt;</span> <i class="conum" data-value="8"></i><b>(8)</b>
           <span class="tag">&lt;http&gt;</span>
              <span class="tag">&lt;url&gt;</span>http://localhost:${tomcat.port}/access<span class="tag">&lt;/url&gt;</span>
           <span class="tag">&lt;/http&gt;</span>
           <span class="tag">&lt;time&gt;</span>10000<span class="tag">&lt;/time&gt;</span>
         <span class="tag">&lt;/wait&gt;</span>
         <span class="tag">&lt;links&gt;</span> <i class="conum" data-value="9"></i><b>(9)</b>
           <span class="tag">&lt;link&gt;</span>database:db<span class="tag">&lt;/link&gt;</span>
         <span class="tag">&lt;/links&gt;</span>
       <span class="tag">&lt;/run&gt;</span>
    <span class="tag">&lt;/image&gt;</span>

    <span class="tag">&lt;image&gt;</span>
      <span class="tag">&lt;alias&gt;</span>database<span class="tag">&lt;/alias&gt;</span> <i class="conum" data-value="10"></i><b>(10)</b>
      <span class="tag">&lt;name&gt;</span>postgres:9<span class="tag">&lt;/name&gt;</span>
      <span class="tag">&lt;run&gt;</span> <i class="conum" data-value="11"></i><b>(11)</b>
        <span class="tag">&lt;wait&gt;</span>
          <span class="tag">&lt;log&gt;</span>database system is ready to accept connections<span class="tag">&lt;/log&gt;</span>
          <span class="tag">&lt;time&gt;</span>20000<span class="tag">&lt;/time&gt;</span>
        <span class="tag">&lt;/wait&gt;</span>
      <span class="tag">&lt;/run&gt;</span>
    <span class="tag">&lt;/image&gt;</span>
  <span class="tag">&lt;/images&gt;</span>
<span class="tag">&lt;/configuration&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Image configuration for a Java service with alias "service" and name <code>fabric8/docker-demo:${project.version}</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><a href="#docker:build">build configuration</a> defines how a Docker image should be created</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Base image, in this case <code>java:8</code></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Content of the image can be specified with an <a href="#build-assembly">assembly descriptor</a></td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td><a href="#misc-startup">Default command</a> to run when a container is created.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td><a href="#docker:run">Run configuration</a> defines how a container should be created from this image</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td><a href="#start-port-mapping">Port mapping</a> defines how container ports should be mapped to host ports</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td><a href="#start-wait">Wait</a> section which is a readiness check when starting the service</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td><a href="#start-links">Network link</a> describes how this service&#8217;s container is linked to the database container</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>Second image is a plain database image which is only needed for running (hence there is no <code>&lt;build&gt;</code> section). The alias is used in the network link section above</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>Wait until the corresponding output appears on stdout when starting the Docker container.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="features">1.5. Features</h3>
<div class="paragraph">
<p>Some other highlights, in random order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Auto pulling of images with a progress indicator</p>
</li>
<li>
<p>Waiting for a container to startup based on time, the reachability of an URL, or a pattern in the log output</p>
</li>
<li>
<p>Support for SSL <a href="#authentication">Authentication</a> and OpenShift credentials</p>
</li>
<li>
<p>Docker machine support</p>
</li>
<li>
<p>Flexible registry handling (i.e. registries can be specified as meta data)</p>
</li>
<li>
<p>Specification of <a href="#password-encryption">encrypted</a> registry passwords for push and pull in ~/.m2/settings.xml (i.e., outside the pom.xml)</p>
</li>
<li>
<p>Color output</p>
</li>
<li>
<p><a href="#docker:watch">Watching</a> on project changes and automatic recreation of image</p>
</li>
<li>
<p><a href="#property-configuration">Properties</a> as alternative to the XML configuration</p>
</li>
<li>
<p>Support for Docker daemons accepting http or https request via TCP and for Unix sockets</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation">2. Installation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This plugin is available from Maven central and can be connected to
pre- and post-integration phase as seen below. The configuration and
available goals are described below.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;plugin&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>io.fabric8<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>docker-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;version&gt;</span>0.15-SNAPSHOT<span class="tag">&lt;/version&gt;</span>

  <span class="tag">&lt;configuration&gt;</span>
     ....
     <span class="tag">&lt;images&gt;</span>
        <span class="comment">&lt;!-- A single's image configuration --&gt;</span>
        <span class="tag">&lt;image&gt;</span>
           ....
        <span class="tag">&lt;/image&gt;</span>
        ....
     <span class="tag">&lt;/images&gt;</span>
  <span class="tag">&lt;/configuration&gt;</span>

  <span class="comment">&lt;!-- Connect start/stop to pre- and
       post-integration-test phase, respectively if you want to start
       your docker containers during integration tests --&gt;</span>
  <span class="tag">&lt;executions&gt;</span>
    <span class="tag">&lt;execution&gt;</span>
       <span class="tag">&lt;id&gt;</span>start<span class="tag">&lt;/id&gt;</span>
       <span class="tag">&lt;phase&gt;</span>pre-integration-test<span class="tag">&lt;/phase&gt;</span>
       <span class="tag">&lt;goals&gt;</span>
         <span class="comment">&lt;!-- &quot;build&quot; should be used to create the images with the
              artifact --&gt;</span>
         <span class="tag">&lt;goal&gt;</span>build<span class="tag">&lt;/goal&gt;</span>
         <span class="tag">&lt;goal&gt;</span>start<span class="tag">&lt;/goal&gt;</span>
       <span class="tag">&lt;/goals&gt;</span>
    <span class="tag">&lt;/execution&gt;</span>
    <span class="tag">&lt;execution&gt;</span>
       <span class="tag">&lt;id&gt;</span>stop<span class="tag">&lt;/id&gt;</span>
       <span class="tag">&lt;phase&gt;</span>post-integration-test<span class="tag">&lt;/phase&gt;</span>
       <span class="tag">&lt;goals&gt;</span>
         <span class="tag">&lt;goal&gt;</span>stop<span class="tag">&lt;/goal&gt;</span>
      <span class="tag">&lt;/goals&gt;</span>
    <span class="tag">&lt;/execution&gt;</span>
  <span class="tag">&lt;/executions&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When working with this plugin you can use an own packaging with a specialized lifecycle in order to keep your pom files small. Three packaging variants are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>docker</strong> : This binds <code>docker:build</code> to the package phase and <code>docker:start</code> / <code>docker:stop</code> to the pre- and post-integration phase respectively. Also <code>docker:push</code> is bound to the deploy phase.</p>
</li>
<li>
<p><strong>docker-build</strong> : Much like the <em>docker</em> packaging, except that there are no integration tests configured by default.</p>
</li>
<li>
<p><strong>docker-tar</strong> : Create a so called <em>Docker tar</em> archive which is used as the artifact and which later can be use for building an image. It contains essentially a <code>Dockerfile</code> with supporting files. See <a href="docker-source">docker:source</a> for more details.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These packaging definitions include the <em>jar</em> lifecycle methods so they are well suited simple Microservice style projects.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;pom&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>demo<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;version&gt;</span>0.0.1<span class="tag">&lt;/version&gt;</span>
  <span class="tag">&lt;packaging&gt;</span>docker<span class="tag">&lt;/packaging&gt;</span>
  ...
  <span class="tag">&lt;build&gt;</span>
    <span class="tag">&lt;plugins&gt;</span>
      <span class="tag">&lt;plugin&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>io.fabric8<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>docker-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;extensions&gt;</span>true<span class="tag">&lt;/extensions&gt;</span>
        <span class="tag">&lt;configuration&gt;</span>
          <span class="tag">&lt;images&gt;</span>
            <span class="tag">&lt;image&gt;</span>
            ...
            <span class="tag">&lt;/image&gt;</span>
          <span class="tag">&lt;/images&gt;</span>
        <span class="tag">&lt;/configuration&gt;</span>
      <span class="tag">&lt;/plugin&gt;</span>
    <span class="tag">&lt;/plugins&gt;</span>
    ....
  <span class="tag">&lt;build&gt;</span>
<span class="tag">&lt;/pom&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This will create the jar (if any), build the Docker images, start the configured Docker containers, runs the integration tests, stops the configured Docker container when you enter <code>mvn install</code>. With <code>mvn deploy</code> you can additionally push the images to a Docker configuration. Please note the <code>&lt;extensions&gt;true&lt;/extensions&gt;</code> which is mandatory when you use a custom lifecycle.</p>
</div>
<div class="paragraph">
<p>The rest of this manual is now about how to configure the plugin for your images.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="global-configuration">3. Global configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Global configuration parameters specify overall behavior like the
connection to the Docker host. The corresponding system properties
which can be used to set it from the outside are given in
parentheses.</p>
</div>
<div class="paragraph">
<p>The docker-maven-plugin uses the Docker remote API so the URL of your
Docker Daemon must somehow be specified. The URL can be specified by
the dockerHost or machine configuration, or by the <code>DOCKER_HOST</code>
environment variable.</p>
</div>
<div class="paragraph">
<p>Since 1.3.0, the Docker remote API supports communication via SSL and
authentication with certificates.  The path to the certificates can
be specified by the certPath or machine configuration, or by the
<code>DOCKER_CERT_PATH</code> environment variable.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Global Configuration</caption>
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 71.4285%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Element</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Property</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>apiVersion</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use this variable if you are using an older version of docker not compatible with the current default use to communicate with the server.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.apiVersion</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>authConfig</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication information when pulling from or pushing to Docker registry. There is a dedicated section <a href="#authentication">Authentication</a> for how doing security.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>autoCreate CustomNetworks</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create automatically Docker networks during <code>docker:start</code> and remove it during <code>docker:stop</code> if you provide a custom network in the run configuration of an image. The default is <code>false</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.autoCreate</code> <code>CustomNetworks</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>autoPull</strong></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Decide how to pull missing base images or images to start:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>on</code> : Automatic download any missing images (default)</p>
</li>
<li>
<p><code>off</code> : Automatic pulling is switched off</p>
</li>
<li>
<p><code>always</code> : Pull images always even when they are already exist locally</p>
</li>
<li>
<p><code>once</code> : For multi-module builds images are only checked once and pulled for the whole build.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.autoPull</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>certPath</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path to SSL certificate when SSL is used for communicating with the Docker daemon. These certificates are normally stored in <code>~/.docker/</code>. With this configuration the path can be set explicitly. If not set, the fallback is first taken from the environment variable <code>DOCKER_CERT_PATH</code> and then as last resort <code>~/.docker/</code>. The keys in this are expected with it standard names <code>ca.pem</code>, <code>cert.pem</code> and <code>key.pem</code>. Please refer to the <a href="https://docs.docker.com/articles/https">Docker documentation</a> for more information about SSL security with Docker.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.certPath</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>dockerHost</strong></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The URL of the Docker Daemon. If this configuration option is not given, then the optional <code>&lt;machine&gt;</code> configuration section is consulted. The scheme of the URL can be either given directly as <code>http</code> or <code>https</code>
depending on whether plain HTTP communication is enabled or SSL should
be used. Alternatively the scheme could be <code>tcp</code> in which case the
protocol is determined via the IANA assigned port: 2375 for <code>http</code>
and 2376 for <code>https</code>. Finally, Unix sockets are supported by using
the scheme <code>unix</code> together with the filesystem path to the unix socket.
The discovery sequence used by the docker-maven-plugin to determine
the URL is:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>value of <strong>dockerHost</strong> (<code>docker.host</code>)</p>
</li>
<li>
<p>the Docker host associated with the docker-machine named in <code>&lt;machine&gt;</code>, i.e. the <code>DOCKER_HOST</code> from <code>docker-machine env</code>. See <a href="#docker-machine">below</a> for more information about Docker machine support.</p>
</li>
<li>
<p>the value of the environment variable <code>DOCKER_HOST</code>.</p>
</li>
<li>
<p><code>unix:///var/run/docker.sock</code> if it is a readable socket.</p>
</li>
</ol>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.host</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>image</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In order to temporarily restrict the operation of plugin goals this configuration option can be used. Typically this will be set via the system property <code>docker.image</code> when Maven is called. The value can be a single image name (either its alias or full name) or it can be a comma separated list with multiple image names. Any name which doesn&#8217;t refer an image in the configuration will be ignored.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.image</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>logDate</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date format which is used for printing out container logs. This configuration can be overwritten by individual run configurations and described below. The format is described in <a href="#loggging">Logging</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.logDate</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>logStdout</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For all container logging to standard output if set to <code>true</code>, regardless whether a <code>file</code> for log output is specified. See also <a href="#start-logging">Logging</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.logStdout</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>machine</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Docker machine configuration. See <a href="#docker-machine">Docker Machine</a> for possible values</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>maxConnections</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of parallel connections are allowed to be opened to the Docker Host. For parsing log output, a connection needs to be kept open (as well for the wait features), so don&#8217;t put that number to low. Default is 100 which should be suitable for most of the cases.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.maxConnections</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>outputDirectory</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default output directory to be used by this plugin. The default value is <code>target/docker</code> and is only used for the goal <code>docker:build</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.target.dir</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>portPropertyFile</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Global property file into which the mapped properties should be written to. The format of this file and its purpose are also described in <a href="#start-port-mapping">Port Mapping</a>.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>registry</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify globally a registry to use for pulling and pushing images. See <a href="#registry">Registry handling</a> for details.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.registry</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>skip</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">With this parameter the execution of this plugin can be skipped completely.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.skip</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>skipBuild</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set not images will be build (which implies also <em>skip.tag</em>) with <code>docker:build</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.skip.build</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>skipPush</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set dont push any images even when <code>docker:push</code> is called.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.skip.push</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>skipRun</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set dont create and start any containers with <code>docker:start</code> or <code>docker:run</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.skip.run</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>skipTag</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to <code>true</code> this plugin won&#8217;t add any tags to images that have been built with <code>docker:build</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.skip.tag</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>skipMachine</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Skip using docker machine in any case</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.skip.machine</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sourceDirectory</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default directory that contains the assembly descriptor(s) used by the plugin. The default value is <code>src/main/docker</code>. This option is only relevant for the <code>docker:build</code> goal.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.source.dir</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>verbose</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean attribute for switching on verbose output like the build steps when doing a Docker build. Default is <code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.verbose</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;configuration&gt;</span>
   <span class="tag">&lt;dockerHost&gt;</span>https://localhost:2376<span class="tag">&lt;/dockerHost&gt;</span>
   <span class="tag">&lt;certPath&gt;</span>src/main/dockerCerts<span class="tag">&lt;/certPath&gt;</span>
   <span class="tag">&lt;useColor&gt;</span>true<span class="tag">&lt;/useColor&gt;</span>
   .....
<span class="tag">&lt;/configuration&gt;</span></code></pre>
</div>
</div>
<div id="docker-machine" class="paragraph">
<div class="title">Docker Machine</div>
<p>This plugin supports also Docker machine (which must be installed locally, of course). A Docker machine configuration can be provided with a top-level <code>&lt;machine&gt;</code> configuration section. This configuration section knows the following options:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. Docker Machine Options</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Element</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Docker machine&#8217;s name. Default is <code>default</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>autoCreate</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if set to <code>true</code> then a Docker machine will automatically created. Default is <code>false</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>createOptions</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map with options for Docker machine when auto-creating a machine. See the docker machine documentation for possible options.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>When no Docker host is configured or available as environment variable, then the configured Docker machine is used. If the machine exists but is not running, it is started automatically. If it does not exists but <code>autoCreate</code> is true, then the machine is created and started. Otherwise an error is printed. Please note, that a machine which has been created because of <code>autoCreate</code> gets never deleted by docker-maven-plugin. This needs to be done manually if required.</p>
</div>
<div class="paragraph">
<p>In absent of a <code>&lt;machine&gt;</code> configuration section the Maven property <code>docker.machine.name</code> can be used to provide the name of a Docker machine. Similarly the property <code>docker.machine.autoCreate</code> can be set to true for creating a Docker machine, too.</p>
</div>
<div class="paragraph">
<p>You can use the property <code>docker.skip.machine</code> if you want to override the internal detection mechanism to always disable docker machine support.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="comment">&lt;!-- Work with a docker-machine --&gt;</span>
<span class="tag">&lt;configuration&gt;</span>
  <span class="tag">&lt;machine&gt;</span>
    <span class="tag">&lt;name&gt;</span>maven<span class="tag">&lt;/name&gt;</span>
    <span class="tag">&lt;autoCreate&gt;</span>true<span class="tag">&lt;/autoCreate&gt;</span>
    <span class="tag">&lt;createOptions&gt;</span>
      <span class="tag">&lt;driver&gt;</span>virtualbox<span class="tag">&lt;/driver&gt;</span>
      <span class="tag">&lt;virtualbox-cpu-count&gt;</span>2<span class="tag">&lt;/virtualbox-cpu-count&gt;</span>
    <span class="tag">&lt;/createOptions&gt;</span>
  <span class="tag">&lt;/machine&gt;</span>
   .....
<span class="tag">&lt;/configuration&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="image-configuration">4. Image configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The plugin&#8217;s configuration is centered around <em>images</em>. These are
specified for each image within the <code>&lt;images&gt;</code> element of the
configuration with one <code>&lt;image&gt;</code> element per image to use.</p>
</div>
<div class="paragraph">
<p>The <code>&lt;image&gt;</code> element can contain the following sub elements:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 3. Image Configuration</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Element</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Each <code>&lt;image&gt;</code> configuration has a mandatory, unique docker
repository <em>name</em>. This can include registry and tag parts, but also placeholder parameters. See below for a detailed explanation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>alias</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shortcut name for an image which can be used for
identifying the image within this configuration. This is used when
linking images together or for specifying it with the global <strong>image</strong> configuration element.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>registry</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Registry to use for this image. If the <code>name</code> already contains a registry this takes precedence. See <a href="#registry">Registry handling</a> for more details.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>build</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Element which contains all the configuration aspects when doing a <a href="#docker:build"><strong>docker:build</strong></a>. This element can be omitted if the image is only pulled from a registry e.g. as support for integration tests like database images.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>run</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Eelement which describe how containers should be
created and run when <a href="#docker:start"><strong>docker:start</strong></a> is called. If this image is only used a <em>data container</em> (i.e. is supposed only to be mounted as a volume) for exporting artifacts via volumes this section can be missing.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>external</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specification of external configuration as an alternative to this XML based configuration with <code>&lt;run&gt;</code> and <code>&lt;build&gt;</code>. It contains a <code>&lt;type&gt;</code> element specifying the handler for getting the configuration. See <a href="#external-configuration">External configuration</a> for details.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Name placeholders</div>
<p>When specifying the name you can use several placeholders which are replaced during runtime by this plugin. In addition you can use regular Maven properties which are resolved by Maven itself.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 4. Placeholders</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Placeholder</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>%g</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The last part of the Maven group name, sanitized so that it can be used as username on GitHub. Only the part after the last dot is used. E.g. for a group id <code>io.fabric8</code> this placeholder would insert <code>fabric8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>%a</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A sanitized version of the artefact id so that it can be used as part of an Docker image name. I.e. it is converted to all lower case (as required by Docker)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>%v</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The project version. Synonym to <code>${project.version}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>%l</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the project version ends with <code>-SNAPSHOT</code> then this placeholder is <code>latest</code>, otherwise its the full version (same as <code>%v</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>%t</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the project version ends with <code>-SNAPSHOT</code> this placeholder resolves to <code>snapshot-&lt;timestamp&gt;</code> where timestamp has the date format <code>yyMMdd-HHmmss-SSSS</code> (eg <code>snapshot-</code>). This feature is especially useful during development in oder to avoid conflicts when images are to be updated which are still in use. You need to take care yourself of cleaning up old images afterwards, though.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Either a <code>&lt;build&gt;</code> or <code>&lt;run&gt;</code> section must be present. These are explained in details in the corresponding goal sections.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;configuration&gt;</span>
  ....
  <span class="tag">&lt;images&gt;</span>
    <span class="tag">&lt;image&gt;</span>
      <span class="tag">&lt;name&gt;</span>%g/docker-demo:0.1<span class="tag">&lt;/name&gt;</span>
      <span class="tag">&lt;alias&gt;</span>service<span class="tag">&lt;/alias&gt;</span>
      <span class="tag">&lt;run&gt;</span>....<span class="tag">&lt;/run&gt;</span>
      <span class="tag">&lt;build&gt;</span>....<span class="tag">&lt;/build&gt;</span>
    <span class="tag">&lt;/image&gt;</span>
  <span class="tag">&lt;/images&gt;</span>
<span class="tag">&lt;/configuration&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="maven-goals">5. Maven Goals</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This plugin supports the following goals which are explained in detail
in the next sections.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 5. Plugin Goals</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Goal</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="#docker:build"><strong>docker:build</strong></a></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Build images</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="#docker:start"><strong>docker:start</strong></a></strong> or <strong><a href="#docker:start">docker:run</a></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create and start containers</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="#docker:stop"><strong>docker:stop</strong></a></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stop and destroy containers</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="#docker:push"><strong>docker:push</strong></a></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Push images to a registry</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="#docker:watch"><strong>docker:watch</strong></a></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Watch for doing rebuilds and restarts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="#docker:remove"><strong>docker:remove</strong></a></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remove images from local docker host</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="#docker:logs"><strong>docker:logs</strong></a></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Show container logs</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><a href="#docker:source"><strong>docker:source</strong></a></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attach docker build archive to Maven project</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note that all goals are orthogonal to each other. For example in order
to start a container for your application you typically have to build
its image before. <code>docker:start</code> does <strong>not</strong> imply building the image
so you should use it then in combination with <code>docker:build</code>.</p>
</div>
<div class="paragraph">
<p>All goals fork the lifecycle phase to call the lifecycle up to the <strong>initialize</strong> phase. This means you can bind other plugins to the phases <strong>initialize</strong> or <strong>validate</strong> for customization. By default no action is bound to these phases. See <a href="https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html">Introduction to the Build Lifecycle</a> for more details about phases and lifecycles.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>Note however that when you bind the goals about to lifecycle phases this will result in the <strong>initialize</strong> and <strong>validate</strong> phase called twice. Your bound plugins should be able to handle this.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="docker:build">5.1. <strong>docker:build</strong></h3>
<div class="paragraph">
<p>This goal will build all images which have a <code>&lt;build&gt;</code> configuration section, or, if the global configuration variable <code>image</code> (property:
<code>docker.image</code>) is set, only the images contained in this variable (comma separated) will be built.</p>
</div>
<div id="build-overview" class="paragraph">
<p>Images can be build in two different ways:</p>
</div>
<div class="paragraph">
<div class="title">Inline plugin configuration</div>
<p>With an inline plugin configuration all information required to build the image is contained in the plugin configuration. By default its the standard XML based configuration for the plugin but can be switched to a property based configuration syntax as described in the section <a href="#external-configuration">External configuration</a>. The XML configuration syntax is recommended because of its more structured and typed nature.</p>
</div>
<div class="paragraph">
<p>When using this mode, the Dockerfile is created on the fly with all instructions extracted from the configuration given.</p>
</div>
<div class="paragraph">
<div class="title">External Dockerfile</div>
<p>Alternatively an external Dockerfile template can be used. This mode is switch on by using one of these two configuration options within
the <code>&lt;build&gt;</code> configuration section.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>dockerFileDir</strong> specifies a directory containing a <code>Dockerfile</code> that will be used to create the image.</p>
</li>
<li>
<p><strong>dockerFile</strong> specifies a specific Dockerfile. The <code>dockerFileDir</code> is set to the directory containing the file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>dockerFileDir</code> is a relative path looked up in <code>${project.basedir}/src/main/docker</code>. You can make easily an absolute path by prefixing with <code>${project.basedir}</code>.</p>
</div>
<div class="paragraph">
<p>Any additional files located in the <code>dockerFileDir</code> directory will also be added to the build context as well as any files specified by an assembly. However, you still need to insert <code>ADD</code> or <code>COPY</code> directives yourself into the Dockerfile.</p>
</div>
<div class="paragraph">
<p>If this directory contains a <code>.maven-dockerignore</code> (or alternatively, a <code>.maven-dockerexclude</code> file), then it is used for excluding files for the build. Each line in this file is treated as an <a href="http://ant.apache.org/manual/Types/fileset.html">FileSet exclude pattern</a> as used by the <a href="http://maven.apache.org/plugins/maven-assembly-plugin">maven-assembly-plugin</a>. It is similar to <code>.dockerignore</code> when using Docker but has a slightly different syntax (hence the different name).</p>
</div>
<div class="paragraph">
<p>If this directory contains a <code>.maven-dockerinclude</code> file, then it is used for including only those files for the build. Each line in this file is also treated as an <a href="http://ant.apache.org/manual/Types/fileset.html">FileSet exclude pattern</a> as used by the <a href="http://maven.apache.org/plugins/maven-assembly-plugin">maven-assembly-plugin</a>.</p>
</div>
<div class="paragraph">
<p>Except for the <a href="#build-assembly">assembly configuration</a> all other configuration options are ignored for now.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>For the future it is planned to introduce special keywords lile <code>DMP_ADD_ASSEMBLY</code> which can be used in the Dockerfile template to placing the configuration resulting from the additional configuration.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>The following example uses a Dockerfile in the directory
<code>src/main/docker/demo</code>:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;plugin&gt;</span>
 <span class="tag">&lt;configuration&gt;</span>
   <span class="tag">&lt;images&gt;</span>
     <span class="tag">&lt;image&gt;</span>
       <span class="tag">&lt;name&gt;</span>user/demo<span class="tag">&lt;/name&gt;</span>
       <span class="tag">&lt;build&gt;</span>
         <span class="tag">&lt;dockerFileDir&gt;</span>demo<span class="tag">&lt;/dockerFileDir&gt;</span>
       <span class="tag">&lt;/build&gt;</span>
     <span class="tag">&lt;/image&gt;</span>
   <span class="tag">&lt;/images&gt;</span>
 <span class="tag">&lt;/configuration&gt;</span>
 ...
<span class="tag">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="build-configuration">5.1.1. Configuration</h4>
<div class="paragraph">
<p>All build relevant configuration is contained in the <code>&lt;build&gt;</code> section
of an image configuration. In addition to <code>&lt;dockerFileDir&gt;</code> and
<code>&lt;dockerFile&gt;</code> the following configuration options are available:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 6. Build configuration</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Element</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>args</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map specifying the value of <a href="https://docs.docker.com/engine/reference/commandline/build/#set-build-time-variables-build-arg">Docker build args</a>
which should be used when building the image with an external Dockerfile which uses build arguments. The key-value syntax is the same as when defining Maven properties (or <code>labels</code> or <code>env</code>).
This argument is ignored when no external Dockerfile is used. Build args can also be specified as properties as
described in <a href="#build-buildargs">Build Args</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>assembly</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">specifies the assembly configuration as described in <a href="#build-assembly">Build Assembly</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cleanup</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cleanup dangling (untagged) images after each build (including any containers created from them). Default is <code>try</code> which tries to remove the old image, but doesn&#8217;t fail the build if this is not possible because e.g. the image is still used by a running container. Use <code>remove</code> if you want to fail the build and <code>none</code> if no cleanup is requested.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>nocache</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Don&#8217;t use Docker&#8217;s build cache. This can be overwritten by setting a system property <code>docker.nocache</code> when running Maven.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cmd</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A command to execute by default (i.e. if no command is provided when a container for this image is started). See <a href="#misc-startup">Startup Arguments</a> for details.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>entryPoint</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An entrypoint allows you to configure a container that will run as an executable. See <a href="#misc-startup">Startup Arguments</a> for details.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>env</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The environments as described in <a href="#misc-env">Setting Environment Variables and Labels</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>from</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The base image which should be used for this image. If not given this default to <code>busybox:latest</code> and is suitable for a pure data image.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>labels</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Labels  as described in <a href="#misc-env">Setting Environment Variables and Labels</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>maintainer</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The author (<code>MAINTAINER</code>) field for the generated image</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ports</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The exposed ports which is a list of <code>&lt;port&gt;</code> elements, one for each port to expose.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>runCmds</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Commands to be run during the build process. It contains <strong>run</strong> elements which are passed to the shell. The run commands are inserted right after the assembly and after <strong>workdir</strong> in to the Dockerfile. This tag is not to be confused with the <code>&lt;run&gt;</code> section for this image which specifies the runtime behaviour when starting containers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>optimise</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if set to true then it will compress all the <code>runCmds</code> into a single <code>RUN</code> directive so that only one image layer is created.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>compression</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The compression mode how the build archive is transmitted to the docker daemon (<code>docker:build</code>) and how docker build archives are attached to this build as sources (<code>docker:source</code>). The value can be <code>none</code> (default), <code>gzip</code> or <code>bzip2</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>skip</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if set to true disables building of the image. This config option is best used together with a maven property</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>tags</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of additional <code>tag</code> elements with which an image is to be tagged after the build.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ulimits</strong></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>ulimits for the container. This list contains <code>&lt;ulimit&gt;</code> elements which three sub elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;name&gt;</code> : The ulimit to set (e.g. <code>memlock</code>). Please refer to the Docker documentation for the possible values to set</p>
</li>
<li>
<p><code>&lt;hard&gt;</code> : The hard limit</p>
</li>
<li>
<p><code>&lt;soft&gt;</code> : The soft limit</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See below for an example.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>user</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User to which the Dockerfile should switch to the end (corresponds to the <code>USER</code> Dockerfile directive).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>volumes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of <code>volume</code> elements to create a container volume.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>workdir</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directory to change to when starting the container.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>From this configuration this Plugin creates an in-memory Dockerfile,
copies over the assembled files and calls the Docker daemon via its
remote API.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;build&gt;</span>
  <span class="tag">&lt;from&gt;</span>java:8u40<span class="tag">&lt;/from&gt;</span>
  <span class="tag">&lt;maintainer&gt;</span>john.doe@example.com<span class="tag">&lt;/maintainer&gt;</span>
  <span class="tag">&lt;tags&gt;</span>
    <span class="tag">&lt;tag&gt;</span>latest<span class="tag">&lt;/tag&gt;</span>
    <span class="tag">&lt;tag&gt;</span>${project.version}<span class="tag">&lt;/tag&gt;</span>
  <span class="tag">&lt;/tags&gt;</span>
  <span class="tag">&lt;ports&gt;</span>
    <span class="tag">&lt;port&gt;</span>8080<span class="tag">&lt;/port&gt;</span>
  <span class="tag">&lt;/ports&gt;</span>
  <span class="tag">&lt;ulimits&gt;</span>
    <span class="tag">&lt;ulimit&gt;</span>
       <span class="tag">&lt;name&gt;</span>memlock<span class="tag">&lt;/name&gt;</span>
       <span class="tag">&lt;hard&gt;</span>-1<span class="tag">&lt;/hard&gt;</span>
       <span class="tag">&lt;soft&gt;</span>-1<span class="tag">&lt;/soft&gt;</span>
    <span class="tag">&lt;/ulimit&gt;</span>
  <span class="tag">&lt;ulimits&gt;</span>
  <span class="tag">&lt;volumes&gt;</span>
    <span class="tag">&lt;volume&gt;</span>/path/to/expose<span class="tag">&lt;/volume&gt;</span>
  <span class="tag">&lt;/volumes&gt;</span>

  <span class="tag">&lt;entryPoint&gt;</span>
    <span class="comment">&lt;!-- exec form for ENTRYPOINT --&gt;</span>
    <span class="tag">&lt;exec&gt;</span>
      <span class="tag">&lt;arg&gt;</span>java<span class="tag">&lt;/arg&gt;</span>
      <span class="tag">&lt;arg&gt;</span>-jar<span class="tag">&lt;/arg&gt;</span>
      <span class="tag">&lt;arg&gt;</span>/opt/demo/server.jar<span class="tag">&lt;/arg&gt;</span>
    <span class="tag">&lt;/exec&gt;</span>
  <span class="tag">&lt;/entryPoint&gt;</span>

  <span class="tag">&lt;assembly&gt;</span>
    <span class="tag">&lt;mode&gt;</span>dir<span class="tag">&lt;/mode&gt;</span>
    <span class="tag">&lt;basedir&gt;</span>/opt/demo<span class="tag">&lt;/basedir&gt;</span>
    <span class="tag">&lt;descriptor&gt;</span>assembly.xml<span class="tag">&lt;/descriptor&gt;</span>
  <span class="tag">&lt;/assembly&gt;</span>
<span class="tag">&lt;/build&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to see the individual build steps you can switch on <code>verbose</code> mode either by setting the property <code>docker.verbose</code> or by using <code>&lt;verbose&gt;true&lt;/verbose&gt;</code> in the <a href="#global-configuration">Global configuration</a></p>
</div>
</div>
<div class="sect3">
<h4 id="build-assembly">5.1.2. Assembly</h4>
<div class="paragraph">
<p>The <code>&lt;assembly&gt;</code> element within <code>&lt;build&gt;</code> is has an XML struture and defines how build artifacts and other files can enter the Docker image.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 7. Assembly Configuration</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Element</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>basedir</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directory under which the files and artifacts contained in the assembly will be copied within the container. The default value for this is <code>/maven</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>inline</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inlined assembly descriptor as described in <a href="#build-assembly-descriptor">Assembly Descriptor</a> below.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>descriptor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path to an assembly descriptor file, whose format is described  <a href="#build-assembly-descriptor">Assembly Descriptor</a> below.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>descriptorRef</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alias to a predefined assembly descriptor. The available aliases are also described in <a href="#build-assembly-descriptor">Assembly Descriptor</a> below.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>dockerFileDir</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directory containing an external Dockerfile. _This option is deprecated, please use &lt;dockerfiledir&gt; directly in the &lt;build&gt; section.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>exportBasedir</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specification whether the <code>basedir</code> should be exported as a volume.  This value is <code>true</code> by default except in the case the <code>basedir</code> is set to the container root (<code>/</code>). It is also <code>false</code> by default when a base image is used with <code>from</code> since exporting makes no sense in this case and will waste disk space unnecessarily.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ignorePermissions</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specification if existing file permissions should be ignored
when creating the assembly archive with a mode <code>dir</code>. This value is <code>false</code> by default. <em>This property is deprecated, use a <code>permissionMode</code> of <code>ignore</code> instead.</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>mode</strong></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Mode how the how the assembled files should be collected:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>dir</code> : Files are simply copied (default),</p>
</li>
<li>
<p><code>tar</code> : Transfer via tar archive</p>
</li>
<li>
<p><code>tgz</code> : Transfer via compressed tar archive</p>
</li>
<li>
<p><code>zip</code> : Transfer via ZIP archive</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The archive formats have the advantage that file permission can be preserved better (since the copying is independent from the underlying files systems), but might triggers internal bugs from the Maven assembler (as it has been reported in <a href="https://github.com/fabric8io/docker-maven-plugin/issues/171">#171</a>)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>permissions</strong></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Permission of the files to add:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ignore</code> to use the permission as found on files regardless on any
assembly configuration</p>
</li>
<li>
<p><code>keep</code> to respect the assembly provided permissions, <code>exec</code> for setting the executable bit on all files (required for Windows when using an assembly mode <code>dir</code>)</p>
</li>
<li>
<p><code>auto</code> to let the plugin select <code>exec</code> on Windows and <code>keep</code> on others.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>keep</code> is the default value.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>user</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User and/or group under which the files should be added. The user must already exist in the base image.
</p><p class="tableblock">It has the general format <code>user[:group[:run-user]]</code>. The user and group can be given either as numeric user- and group-id or as names. The group id is optional.
</p><p class="tableblock">If a third part is given, then the build changes to user <code>root</code> before changing the ownerships, changes the ownerships and then change to user <code>run-user</code> which is then used for the final command to execute. This feature might be needed, if the base image already changed the user (e.g. to 'jboss') so that a <code>chown</code> from root to this user would fail.
</p><p class="tableblock">For example, the image <code>jboss/wildfly</code> use a "jboss" user under which all commands are executed. Adding files in Docker always happens under the UID root. These files can only be changed to "jboss" is the <code>chown</code> command is executed as root. For the following commands to be run again as "jboss" (like the final <code>standalone.sh</code>), the plugin switches back to user <code>jboss</code> (this is this "run-user") after changing the file ownership. For this example a specification of
<code>jboss:jboss:jboss</code> would be required.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In the event you do not need to include any artifacts with the image, you may safely omit this element from the configuration.</p>
</div>
<div class="sect4">
<h5 id="build-assembly-descriptor">Assembly Descriptor</h5>
<div class="paragraph">
<p>With using the <code>inline</code>, <code>descriptor</code> or <code>descriptorRef</code> option
it is possible to bring local files, artifacts and dependencies into
the running Docker container. A <code>descriptor</code> points to a file
describing the data to put into an image to build. It has the same
<a href="http://maven.apache.org/plugins/maven-assembly-plugin/assembly.html">format</a> as for creating assemblies with the
<a href="http://maven.apache.org/plugins/maven-assembly-plugin">maven-assembly-plugin</a> with following exceptions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;formats&gt;</code> are ignored, the assembly will allways use a directory
when preparing the data container (i.e. the format is fixed to
<code>dir</code>)</p>
</li>
<li>
<p>The <code>&lt;id&gt;</code> is ignored since only a single assembly descriptor is
used (no need to distinguish multiple descriptors)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Also you can inline the assembly description with a <code>inline</code> description
directly into the pom file. Adding the proper namespace even allows for
IDE autocompletion. As an example, refer to the profile <code>inline</code> in
the `data-jolokia-demo&#8217;s pom.xml.</p>
</div>
<div class="paragraph">
<p>Alternatively <code>descriptorRef</code> can be used with the name of a
predefined assembly descriptor. The following symbolic names can be
used for <code>descriptorRef</code>:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 8. Predefined Assembly Descriptors</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Assembly Reference</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>artifact-with-dependencies</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attaches project&#8217;s artifact and all its dependencies. Also, when a <code>classpath</code> file exists in the target directory, this will be added to.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>artifact</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attaches only the project&#8217;s artifact but no dependencies.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>project</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attaches the whole Maven project but with out the <code>target/</code> directory.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>rootWar</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Copies the artifact as <code>ROOT.war</code> to the exposed directory. I.e. Tomcat will then deploy the war under the root context.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;images&gt;</span>
  <span class="tag">&lt;image&gt;</span>
    <span class="tag">&lt;build&gt;</span>
      <span class="tag">&lt;assembly&gt;</span>
         <span class="tag">&lt;descriptorRef&gt;</span>artifact-with-dependencies<span class="tag">&lt;/descriptorRef&gt;</span>
         .....</code></pre>
</div>
</div>
<div class="paragraph">
<p>will add the created artifact with the name <code>${project.build.finalName}.${artifact.extension}</code> and all jar dependencies in the the <code>baseDir</code> (which is <code>/maven</code> by default).</p>
</div>
<div class="paragraph">
<p>All declared files end up in the configured <code>basedir</code> (or <code>/maven</code> by default) in the created image.</p>
</div>
<div class="paragraph">
<p>If the assembly references the artifact to build with this pom, it is required that the <code>package</code> phase is included in the run. This happens either automatically when the <code>docker:build</code> target is called as part of a binding (e.g. is <code>docker:build</code> is bound to the <code>pre-integration-test</code>
phase) or it must be ensured when called on the command line:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sh">mvn package docker:build</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a general restriction of the Maven lifecycle which applies also
for the <code>maven-assembly-plugin</code> itself.</p>
</div>
<div class="paragraph">
<p>In the following example a dependency from the pom.xml is included and
mapped to the name <code>jolokia.war</code>. With this configuration you will end
up with an image, based on <code>busybox</code> which has a directory <code>/maven</code>
containing a single file <code>jolokia.war</code>. This volume is also exported
automatically.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;assembly&gt;</span>
  <span class="tag">&lt;dependencySets&gt;</span>
    <span class="tag">&lt;dependencySet&gt;</span>
      <span class="tag">&lt;includes&gt;</span>
        <span class="tag">&lt;include&gt;</span>org.jolokia:jolokia-war<span class="tag">&lt;/include&gt;</span>
      <span class="tag">&lt;/includes&gt;</span>
      <span class="tag">&lt;outputDirectory&gt;</span>.<span class="tag">&lt;/outputDirectory&gt;</span>
      <span class="tag">&lt;outputFileNameMapping&gt;</span>jolokia.war<span class="tag">&lt;/outputFileNameMapping&gt;</span>
    <span class="tag">&lt;/dependencySet&gt;</span>
  <span class="tag">&lt;/dependencySets&gt;</span>
<span class="tag">&lt;/assembly&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Another container can now connect to the volume an 'mount' the
<code>/maven</code> directory. A container  from <code>consol/tomcat-7.0</code> will look
into <code>/maven</code> and copy over everything to <code>/opt/tomcat/webapps</code> before
starting Tomcat.</p>
</div>
<div class="paragraph">
<p>If you are using the <code>artifact</code> or <code>artifact-with-dependencies</code> descriptor, it is
possible to change the name of the final build artifact with the following:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;build&gt;</span>
  <span class="tag">&lt;finalName&gt;</span>your-desired-final-name<span class="tag">&lt;/finalName&gt;</span>
  ...
<span class="tag">&lt;/build&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note, based upon the following documentation listed <a href="http://maven.apache.org/pom.html#BaseBuild_Element">here</a>, there is no guarantee the plugin creating your artifact will honor it in which case you will need to use a custom descriptor like above to achieve the desired naming.</p>
</div>
<div class="paragraph">
<p>Currently the <code>jar</code> and <code>war</code> plugins properly honor the usage of <code>finalName</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="misc-startup">5.1.3. Startup Arguments</h4>
<div class="paragraph">
<p>Using <code>entryPoint</code> and <code>cmd</code> it is possible to specify the <a href="https://docs.docker.com/reference/builder/#entrypoint">entry point</a>
or <a href="https://docs.docker.com/reference/builder/#cmd">cmd</a> for a container.</p>
</div>
<div class="paragraph">
<p>The difference is, that an <code>entrypoint</code> is the command that always be executed, with the <code>cmd</code> as argument. If no <code>entryPoint</code> is provided, it defaults to <code>/bin/sh -c</code> so any <code>cmd</code> given is executed with a shell. The arguments given to <code>docker run</code> are always given as arguments to the
<code>entrypoint</code>, overriding any given <code>cmd</code> option. On the other hand if no extra arguments are given to <code>docker run</code> the default <code>cmd</code> is used as argument to <code>entrypoint</code>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>See this <a href="http://stackoverflow.com/questions/21553353/what-is-the-difference-between-cmd-and-entrypoint-in-a-dockerfile">stackoverflow question</a> for a detailed explanation.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>A entry point or command can be specified in two alternative formats:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 9. Entrypoint and Command Configuration</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Mode</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>shell</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shell form in which the whole line is given to <code>shell -c</code> for interpretation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>exec</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of arguments (with inner <code>&lt;args&gt;</code>) arguments which will be given to the <code>exec</code> call directly without any shell interpretation.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Either shell or params should be specified.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;entryPoint&gt;</span>
   <span class="comment">&lt;!-- shell form  --&gt;</span>
   <span class="tag">&lt;shell&gt;</span>java -jar $HOME/server.jar<span class="tag">&lt;/shell&gt;</span>
<span class="tag">&lt;/entryPoint&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;entryPoint&gt;</span>
   <span class="comment">&lt;!-- exec form  --&gt;</span>
   <span class="tag">&lt;exec&gt;</span>
     <span class="tag">&lt;args&gt;</span>java<span class="tag">&lt;/args&gt;</span>
     <span class="tag">&lt;args&gt;</span>-jar<span class="tag">&lt;/args&gt;</span>
     <span class="tag">&lt;args&gt;</span>/opt/demo/server.jar<span class="tag">&lt;/args&gt;</span>
   <span class="tag">&lt;/exec&gt;</span>
<span class="tag">&lt;/entryPoint&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This can be formulated also more dense with:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="comment">&lt;!-- shell form  --&gt;</span>
<span class="tag">&lt;entryPoint&gt;</span>java -jar $HOME/server.jar<span class="tag">&lt;/entryPoint&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;entryPoint&gt;</span>
  <span class="comment">&lt;!-- exec form  --&gt;</span>
  <span class="tag">&lt;arg&gt;</span>java<span class="tag">&lt;/arg&gt;</span>
  <span class="tag">&lt;arg&gt;</span>-jar<span class="tag">&lt;/arg&gt;</span>
  <span class="tag">&lt;arg&gt;</span>/opt/demo/server.jar<span class="tag">&lt;/arg&gt;</span>
<span class="tag">&lt;/entryPoint&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="build-buildargs">5.1.4. Build Args</h4>
<div class="paragraph">
<p>As described in section <a href="#build-configuration">Configuration</a> for external Dockerfiles <a href="https://docs.docker.com/engine/reference/commandline/build/#set-build-time-variables-build-arg">Docker build arg</a> can be used. In addition to the
configuration within the plugin configuration you can also use properties to specify them:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set a system property when running Maven, eg.: <code>-Ddocker.buildArg.http_proxy=http://proxy:8001</code>. This is especially
useful when using predefined Docker arguments for setting proxies transparently.</p>
</li>
<li>
<p>Set a project property within the <code>pom.xml</code>, eg.:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">  <span class="tag">&lt;docker.buildArg.myBuildArg&gt;</span>myValue<span class="tag">&lt;/docker.buildArg.myBuildArg&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note that the system property setting will always override the project property. Also note that for all properties which are not Docker <a href="https://docs.docker.com/engine/reference/builder/#arg">predefined</a> properties, the external Dockerfile must contain an <code>ARGS</code> instruction.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="docker:start">5.2. <strong>docker:start</strong></h3>
<div id="start-overview" class="paragraph">
<p>This goal creates and starts docker containers. This goals evaluates the configuration&#8217;s <code>&lt;run&gt;</code> section of all given (and enabled images). In order to switch on globally the logs <strong>showLogs</strong> can be used as global configuration (i.e. outside of <code>&lt;images&gt;</code>). If set it will print out all standard output and standard error messages for all containers started. As value the images for which logs should be shown can be given as a comma separated list. This is probably most useful when used from the command line as system property <code>docker.showLogs</code>.</p>
</div>
<div class="paragraph">
<p>Also you can specify <code>docker.follow</code> as system property so that the <code>docker:start</code> will never return but block until CTRL-C is pressed. That similar to the option <code>-i</code> for <code>docker run</code>. This will automatically switch on <code>showLogs</code> so that you can see what is happening within the container. Also, after stopping with CTRL-C, the container is stopped (but not removed so that you can make postmortem analysis).</p>
</div>
<div class="paragraph">
<p>By default container specific properties are exposed as Maven properties. These properties have the format <code>docker.container.`<em>alias</em></code>.`<em>prop</em> where <em>alias</em> is the name of the container (see below) and <em>prop</em> is one of the following container properties:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 10. Properties provided</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ip</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internal IP address of the container.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>id</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Container id</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For example the Maven property <code>docker.container.tomcat.ip</code> would hold the Docker internal IP for a container with an alias "tomcat". You can set the global configuration <strong>exposeContainerInfo</strong> to an empty string to not expose container information that way or to a string for an other prefix than <code>docker.container</code>.</p>
</div>
<div class="sect3">
<h4 id="start-configuration">5.2.1. Configuration</h4>
<div class="paragraph">
<p>The <code>&lt;run&gt;</code> configuration element knows the following sub elements:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 11. Run configuration</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Element</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>capAdd</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of <code>add</code> elements to specify kernel parameters to add to the container.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>capDrop</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of <code>drop</code> elements to specify kernel parameters to remove from the container.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cmd</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Command which should be executed at the end of the container&#8217;s startup. If not given, the image&#8217;s default command is used. See <a href="#misc-startup">Startup Arguments</a> for details.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>domainname</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Domain name for the container</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>dns</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of <code>host</code> elements specifying dns servers for the container to use</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>dnsSearch</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of <code>host</code> elements specifying dns search domains</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>entrypoint</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Entry point for the container. See &lt;&lt;misc-startup, Startup Arguments] for details.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>env</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Environment variables as subelements which are set during startup of the container. They are specified in the typical maven property format as described <a href="#misc-env">Environment and Labels</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>envPropertyFile</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path to a property file holding environment variables. If given, the variables specified in this property file overrides the environment variables specified in the configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>extraHosts</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of <code>host</code> elements in the form <code>host:ip</code> to add to the container&#8217;s <code>/etc/hosts</code> file. Additionally, you may specify a <code>host</code> element in the form <code>host:host</code> to have the right side host ip address resolved at container startup.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>hostname</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hostname of the container</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>labels</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Labels which should be attached to the  container. They are specified in the typical maven property format as described in <a href="#misc-env">Environment and Labels</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>links</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network links for connecting containers together as described in  <a href="#start-links">Network Links</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>log</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log configuration for whether and how log messages from the running containers should be printed. This also can configure the <a href="https://docs.docker.com/engine/admin/logging/overview">log driver</a> to use. See <a href="#start-logging">Logging</a> for a detailed description.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>memory</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Memory limit in bytes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>memorySwap</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total memory usage (memory + swap); use -1 to disable swap.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>namingStrategy</strong></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Naming strategy for how the container name is created:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>none</strong> : uses randomly assigned names from docker (default)</p>
</li>
<li>
<p><strong>alias</strong> : uses the <code>alias</code> specified in the <code>image</code> configuration. An error is thrown, if a container already exists with this name.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>net</strong></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Network mode for the container:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>bridge</strong> : Bridged mode with the default Docker bridge (default)</p>
</li>
<li>
<p><strong>host</strong> : Share the Docker host network interfaces</p>
</li>
<li>
<p><strong>container:&lt;alias or name&gt;</strong> : Connect to the network of the specified container</p>
</li>
<li>
<p><strong>&lt;custom network&gt;</strong> : Use the specified custom network which must be created before with <code>docker network create</code>. Available for Docker 1.9 and newer. For more about the networking options please refer to the <a href="https://docs.docker.com/engine/userguide/networking/work-with-networks">Docker documentation</a>.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>portPropertyFile</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">File path into which the mapped port properties are written. The format of this file and its purpose are also described in <a href="#start-port-mapping">Port mapping</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ports</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#start-port-mapping">Port mappings</a> for exposing container ports to host ports.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>privileged</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code> give container full access to host</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>restartPolicy</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#start-restart">Restart Policy</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>shmSize</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size of <code>/dev/shm</code> in bytes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>skip</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code> disable creating and starting of the container. This option is best used together with a Maven property which can be set from the outside.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>user</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User used inside the container</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>volumes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Volume configuration for binding to host directories and from other containers. See <a href="#start-volumes">Volumes</a> for details.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>wait</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Condition which must be fulfilled for the startup to complete. See <a href="#start-wait">Wait</a> for all possible ways to wait for a startup condition.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>workingDir</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Working directory for commands to run in</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;run&gt;</span>
  <span class="tag">&lt;env&gt;</span>
    <span class="tag">&lt;CATALINA_OPTS&gt;</span>-Xmx32m<span class="tag">&lt;/CATALINA_OPTS&gt;</span>
    <span class="tag">&lt;JOLOKIA_OFF</span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/env&gt;</span>
  <span class="tag">&lt;labels&gt;</span>
    <span class="tag">&lt;environment&gt;</span>development<span class="tag">&lt;/environment&gt;</span>
    <span class="tag">&lt;version&gt;</span>${project.version}<span class="tag">&lt;/version&gt;</span>
  <span class="tag">&lt;/labels&gt;</span>
  <span class="tag">&lt;ports&gt;</span>
    <span class="tag">&lt;port&gt;</span>jolokia.port:8080<span class="tag">&lt;/port&gt;</span>
  <span class="tag">&lt;/ports&gt;</span>
  <span class="tag">&lt;links&gt;</span>
    <span class="tag">&lt;link&gt;</span>db<span class="tag">&lt;/db&gt;</span>
  <span class="tag">&lt;/links&gt;</span>
  <span class="tag">&lt;wait&gt;</span>
    <span class="tag">&lt;http&gt;</span>
      <span class="tag">&lt;url&gt;</span>http://localhost:${jolokia.port}/jolokia<span class="tag">&lt;/url&gt;</span>
    <span class="tag">&lt;/http&gt;</span>
    <span class="tag">&lt;time&gt;</span>10000<span class="tag">&lt;/time&gt;</span>
  <span class="tag">&lt;/wait&gt;</span>
  <span class="tag">&lt;log&gt;</span>
    <span class="tag">&lt;prefix&gt;</span>DEMO<span class="tag">&lt;/prefix&gt;</span>
    <span class="tag">&lt;date&gt;</span>ISO8601<span class="tag">&lt;/date&gt;</span>
    <span class="tag">&lt;color&gt;</span>blue<span class="tag">&lt;/color&gt;</span>
  <span class="tag">&lt;/log&gt;</span>
  <span class="tag">&lt;cmd&gt;</span>java -jar /maven/docker-demo.jar<span class="tag">&lt;/cmd&gt;</span>
<span class="tag">&lt;/run&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="misc-env">5.2.2. Environment and Labels</h4>
<div class="paragraph">
<p>When creating a container one or more environment variables can be set via configuration with the <code>env</code> parameter</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;env&gt;</span>
  <span class="tag">&lt;JAVA_HOME&gt;</span>/opt/jdk8<span class="tag">&lt;/JAVA_HOME&gt;</span>
  <span class="tag">&lt;CATALINA_OPTS&gt;</span>-Djava.security.egd=file:/dev/./urandom<span class="tag">&lt;/CATALINA_OPTS&gt;</span>
<span class="tag">&lt;/env&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you put this configuration into profiles you can easily create various test variants with a single image (e.g. by switching the JDK or whatever).</p>
</div>
<div class="paragraph">
<p>It is also possible to set the environment variables from the outside of the plugin&#8217;s configuration with the parameter <code>envPropertyFile</code>. If given, this property file is used to set the environment variables where the keys and values specify the environment variable. Environment variables specified in this file override any environment variables specified in the configuration.</p>
</div>
<div class="paragraph">
<p>Labels can be set inline the same way as environment variables:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;labels&gt;</span>
   <span class="tag">&lt;com.example.label-with-value&gt;</span>foo<span class="tag">&lt;/com.example.label-with-value&gt;</span>
   <span class="tag">&lt;version&gt;</span>${project.version}<span class="tag">&lt;/version&gt;</span>
   <span class="tag">&lt;artifactId&gt;</span>${project.artifactId}<span class="tag">&lt;/artifactId&gt;</span>
<span class="tag">&lt;/labels&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="start-port-mapping">5.2.3. Port Mapping</h4>
<div class="paragraph">
<p>The <code>&lt;ports&gt;</code> configuration contains a list of port mappings. Each mapping has multiple parts, each separate by a colon. This is equivalent to the port mapping when using the Docker CLI with option <code>-p</code>.</p>
</div>
<div class="paragraph">
<p>A <code>port</code> stanza may take one of the following forms:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 12. Port mapping format</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Format</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>18080:8080</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tuple consisting of two numeric values separated by a <code>:</code>. This form will result in an explicit mapping between the docker host and the corresponding port inside the container. In the above example, port 18080 would be exposed on the docker host and mapped to port 8080 in the running container.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>host.port</em>:80</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tuple consisting of a string and a numeric value separated by a <code>:</code>. In this form, the string portion of the tuple will correspond to a Maven property. If the property is undefined when the <code>start</code> task executes, a port will be dynamically selected by Docker in the ephemeral port range and assigned to the property which may then be used later in the same POM file. The ephemeral port range is configured by the <code>/proc/sys/net/ipv4/ip_local_port_range</code> kernel parameter, which typically ranges from 32678 to 61000.  If the property exists and has numeric value, that value will be used as the exposed port on the docker host as in the previous form. In the above example, the docker service will elect a new port and assign the value to the property <code>host.port</code> which may then later be used in a property expression similar to <code>&lt;value&gt;${host.port}&lt;/value&gt;</code>. This can be used to pin a port from the outside when doing some initial testing similar to <code>mvn -Dhost.port=10080 docker:start</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>bindTo:_host.port_:80</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tuple consisting of two strings and a numeric value separated by a <code>:</code>. In this form, <code>bindTo</code> is an ip address on the host the container should bind to. As a convenience, a hostname pointing to the docker host may also be specified. The container will fail to start if the hostname can not be resolved.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>+host.ip:_host.port_:80</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tuple consisting of two strings and a numeric value separated by a <code>:</code>. In this form, the host ip of the container will be placed into a Maven property name <code>host.ip</code>. If docker reports that value to be <code>0.0.0.0</code>, the value of <code>docker.host.address</code> will be substituted instead. In the event you want to use this form and have the container bind to a specific hostname/ip address, you can declare a Maven property of the same name (<code>host.ip</code> in this example) containing the value to use. <code>host:port</code> works in the same way as described above.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following are examples of valid configuration entries:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;properties&gt;</span>
  <span class="tag">&lt;bind.host.ip&gt;</span>1.2.3.4<span class="tag">&lt;/bind.host.ip&gt;</span>
  <span class="tag">&lt;bind.host.name&gt;</span>some.host.pvt<span class="tag">&lt;/bind.host.name&gt;</span>
<span class="tag">&lt;properties&gt;</span>

...

<span class="tag">&lt;ports&gt;</span>
  <span class="tag">&lt;port&gt;</span>18080:8080<span class="tag">&lt;/port&gt;</span>
  <span class="tag">&lt;port&gt;</span>host.port:80<span class="tag">&lt;/port&gt;</span>
  <span class="tag">&lt;port&gt;</span>127.0.0.1:80:80<span class="tag">&lt;/port&gt;</span>
  <span class="tag">&lt;port&gt;</span>localhost:host.port:80<span class="tag">&lt;/port&gt;</span>
  <span class="tag">&lt;port&gt;</span>+container.ip.property:host.port:5678<span class="tag">&lt;/port&gt;</span>
  <span class="tag">&lt;port&gt;</span>+bind.host.ip:host.port:5678<span class="tag">&lt;/port&gt;</span>
  <span class="tag">&lt;port&gt;</span>+bind.host.name:5678:5678<span class="tag">&lt;/port&gt;</span>
<span class="tag">&lt;ports&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Another useful configuration option is <code>portPropertyFile</code> which can be used to to write out the container&#8217;s host ip and any dynamic ports that have been resolved. The keys of this property file are the property names defined in the port mapping configuration and their values those of the corresponding docker attributes.</p>
</div>
<div class="paragraph">
<p>This property file might be useful with tests or with other maven plugins that will be unable to use the resolved properties because they can only be updated after the container has started and plugins resolve their properties in an earlier lifecycle phase.</p>
</div>
<div class="paragraph">
<p>If you don&#8217;t need to write out such a property file and thus don&#8217;t need to preserve the property names, you can use normal maven properties as well. E.g. <code>${host.var}:${port.var}:8080</code> instead of
<code>+host.var:port.var:8080</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="start-links">5.2.4. Network Links</h4>
<div class="paragraph">
<p>The <code>&lt;links&gt;</code> configuration contains a list of containers that should
be linked to this container according to <a href="https://docs.docker.com/userguide/dockerlinks">Docker Links</a>. Each link can have two parts where the optional right side is separated by a <code>:</code> and will be used as the name in the environment variables and the left side refers to the name of the container linking to. This is equivalent to the linking when using the Docker CLI <code>--link</code> option.</p>
</div>
<div class="paragraph">
<p>Example for linking to a container with name or alias <em>postgres</em> :</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;links&gt;</span>
  <span class="tag">&lt;link&gt;</span>postgres:db<span class="tag">&lt;/link&gt;</span>
<span class="tag">&lt;/links&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This will create the following environment variables, given that the postgres image exposes TCP port 5432:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">DB_NAME=/web2/db
DB_PORT=tcp://172.17.0.5:5432
DB_PORT_5432_TCP=tcp://172.17.0.5:5432
DB_PORT_5432_TCP_PROTO=tcp
DB_PORT_5432_TCP_PORT=5432
DB_PORT_5432_TCP_ADDR=172.17.0.5</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you wish to link to existing containers not managed by the plugin, you may do so by specifying the container name obtained via <code>docker ps</code> in the configuration.</p>
</div>
<div class="paragraph">
<p>Please note that the link behaviour also depends on the network mode selected. Links as described are referred to by Docker as <em>legacy links</em> and might vanish in the future. For custom networks no environments variables are set and links create merely network aliases for the linked container.</p>
</div>
<div class="paragraph">
<p>For a more detailed documentation for the new link handling please refer to the <a href="https://docs.docker.com/engine/userguide/networking/work-with-networks/#linking-containers-in-user-defined-networks">Docker network documentation</a></p>
</div>
</div>
<div class="sect3">
<h4 id="start-restart">5.2.5. Restart Policy</h4>
<div class="paragraph">
<p>Specify the behavior to apply when the container exits. These values can be specified withing a <code>&lt;restartPolicy&gt;</code> section with the following sub-elements:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 13. Restart Policy configuration</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Element</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>name</strong></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Restart policy name, choose from:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>always</code> (<em>v1.15</em>) always restart</p>
</li>
<li>
<p><code>on-failure</code> (<em>v1.15</em>) restart on container non-exit code of zero</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>retry</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>on-failure</code> is used, controls max number of attempts to restart before giving up.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The behavior to apply when the container exits. The value is an object with a name property of either "always" to always restart or "on-failure" to restart only when the container exit code is non-zero. If on-failure is used, MaximumRetryCount controls the number of times to retry before giving up. The default is not to restart. (optional)</p>
</div>
</div>
<div class="sect3">
<h4 id="start-volumes">5.2.6. Volumes</h4>
<div class="paragraph">
<p>A container can bind (or "mount") volumes from various source when starting up: Either from a directory of the host system or from another container which exports one or more directories. The mount configuration is specified within a <code>&lt;volumes&gt;</code> section of the run configuration. It can contain the following sub elements:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 14. Volume configuration</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Element</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>from</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of <code>&lt;image&gt;</code> elements which specify image names or aliases of containers whose volumes should be imported.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>bind</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of <code>&lt;volume&gt;</code> specifications (or <em>host mounts</em>). Use <code>/path</code> to create and expose a new volume in the container, <code>/host_path:/container_path</code> to mount a host path into the container and <code>/host_path:/container_path:ro</code> to bind it read-only.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Volumes example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;volumes&gt;</span>
  <span class="tag">&lt;bind&gt;</span>
    <span class="tag">&lt;volume&gt;</span>/logs<span class="tag">&lt;/volume&gt;</span>
    <span class="tag">&lt;volume&gt;</span>/opt/host_export:/opt/container_import<span class="tag">&lt;/volume&gt;</span>
  <span class="tag">&lt;/bind&gt;</span>
  <span class="tag">&lt;from&gt;</span>
    <span class="tag">&lt;image&gt;</span>jolokia/docker-demo<span class="tag">&lt;/image&gt;</span>
  <span class="tag">&lt;/from&gt;</span>
<span class="tag">&lt;/volumes&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example the container creates a new volume named  <code>/logs</code> on the container and mounts <code>/opt/host_export</code> from the host as <code>/opt/container_import</code> on the container. In addition all exported volumes from the container which has been created from the image <code>jolokia/docker-demo</code> are mounted directly into the container (with the same directory names under which the exporting container exposes these directories). This image must be also configured for this plugin. Instead of the full image name, an alias name can be used, too.</p>
</div>
<div class="paragraph">
<p>Please note, that no relative paths are allowed. However, you can use Maven variables in the path specifications. This should even work for boot2docker and docker-machine:</p>
</div>
<div class="listingblock">
<div class="title">Example with absolute paths</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;volumes&gt;</span>
  <span class="tag">&lt;bind&gt;</span>
    <span class="tag">&lt;volume&gt;</span>${project.build.directory}/${project.artifactId}-${project.version}:/usr/local/tomcat/webapps/${project.name}<span class="tag">&lt;/volume&gt;</span>
    <span class="tag">&lt;volume&gt;</span>${project.basedir}/data:/data<span class="tag">&lt;/volume&gt;</span>
  <span class="tag">&lt;/bind&gt;</span>
<span class="tag">&lt;/volumes&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you wish to mount volumes from an existing container not managed by the plugin, you may do by specifying the container name obtained via <code>docker ps</code> in the configuration.</p>
</div>
</div>
<div class="sect3">
<h4 id="start-wait">5.2.7. Wait</h4>
<div class="paragraph">
<p>While starting a container is it possible to block the execution until
some condition is met. These conditions can be specified within a
<code>&lt;wait&gt;</code> section which the following sub-elements:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 15. Wait configuration</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Element</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>http</strong></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>HTTP ping check which periodically polls an URL. It knows the following sub-elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>url</strong> holds an URL and is mandatory</p>
</li>
<li>
<p><strong>method</strong> Optional HTTP method to use.</p>
</li>
<li>
<p><strong>status</strong> Status code which if returned is considered to be a successful ping. This code can be given either as a single number (200) or as a range (200..399). The default is <code>200..399</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>log</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Regular expression which is applied against the log
output of an container and blocks until the pattern is matched.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>time</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time in milliseconds to block.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>kill</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time in milliseconds between sending <code>SIGTERM</code> and <code>SIGKILL</code> when stopping a container. Since docker itself uses second granularity, you should use at least 1000 milliseconds.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>shutdown</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time to wait in milliseconds between stopping a container and removing it. This might be helpful in situation where a Docker croaks with an error when trying to remove a container to fast after it has been stopped.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>exec</strong></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Commands to execute during specified lifecycle of the container. It knows the following sub-elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>postStart</strong> Command to run after the above wait criteria has been met</p>
</li>
<li>
<p><strong>preStop</strong> Command to run before the container is stopped.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>tcp</strong></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>TCP port check which periodically polls given tcp ports. It knows the following sub-elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>mode</strong> can be either <code>mapped</code> which uses the mapped ports or <code>direct</code> in which case the container ports are addressed directly. In the later case the host field should be left empty in order to select the container ip (which must be routed which is only the case when running on the Docker daemon&#8217;s host directly). Default is <code>direct</code> when host is <em>localhost</em>, <code>mapped</code> otherwise. The direct mode might help when a so called <em>user-proxy</em> is enabled on the Docker daemon which makes the mapped ports directly available even when the container is not ready yet.</p>
</li>
<li>
<p><strong>host</strong> is the hostname or the IP address. It defaults to <code>${docker.host.address}</code> for a mapped mode and the container ip address for the direct mode.</p>
</li>
<li>
<p><strong>ports</strong> is a list of TCP ports to check. These are supposed to be the container internal ports.</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>As soon as one condition is met the build continues. If you add a <code>&lt;time&gt;</code> constraint this works more or less as a timeout for other conditions. The build will abort if you wait on an url or log output and reach the timeout. If only a <code>&lt;time&gt;</code> is specified, the build will wait that amount of milliseconds and then continues.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;wait&gt;</span>
  <span class="tag">&lt;http&gt;</span>
    <span class="tag">&lt;url&gt;</span>http://localhost:${host.port}<span class="tag">&lt;/url&gt;</span>
    <span class="tag">&lt;method&gt;</span>GET<span class="tag">&lt;/method&gt;</span>
    <span class="tag">&lt;status&gt;</span>200..399<span class="tag">&lt;/status&gt;</span>
  <span class="tag">&lt;/http&gt;</span>
  <span class="tag">&lt;time&gt;</span>10000<span class="tag">&lt;/time&gt;</span>
  <span class="tag">&lt;kill&gt;</span>1000<span class="tag">&lt;/kill&gt;</span>
  <span class="tag">&lt;shutdown&gt;</span>500<span class="tag">&lt;/shutdown&gt;</span>
  <span class="tag">&lt;exec&gt;</span>
     <span class="tag">&lt;postStart&gt;</span>/opt/init_db.sh<span class="tag">&lt;/postStart&gt;</span>
     <span class="tag">&lt;preStop&gt;</span>/opt/notify_end.sh<span class="tag">&lt;/preStop&gt;</span>
  <span class="tag">&lt;/exec&gt;</span>
  <span class="tag">&lt;tcp&gt;</span>
     <span class="tag">&lt;host&gt;</span>192.168.99.100<span class="tag">&lt;/host&gt;</span>
     <span class="tag">&lt;ports&gt;</span>
        <span class="tag">&lt;port&gt;</span>3306<span class="tag">&lt;/port&gt;</span>
        <span class="tag">&lt;port&gt;</span>9999<span class="tag">&lt;/port&gt;</span>
     <span class="tag">&lt;/ports&gt;</span>
  <span class="tag">&lt;/tcp&gt;</span>
<span class="tag">&lt;/wait&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This setup will wait for the given URL to be reachable but ten seconds at most. Additionally, it will be waited for the TCP ports 3306 and 9999. Also, when stopping the container after an integration tests, the build wait for 500 ms before it tries to remove the container (if not <code>keepContainer</code> or <code>keepRunning</code> is used). You can use maven properties in each condition, too. In the example, the <code>${host.port}</code> property is probably set before within a port mapping section.</p>
</div>
<div class="paragraph">
<p>The property <code>${docker.host.address}</code> is set implicitly to the address of the Docker host. This host will be taken from the <code>docker.host</code> configuration if HTTP or HTTPS is used. If a Unix socket is used for communication with the docker daemon, then <code>localhost</code> is assumed. You can override this property always by setting this Maven property explicitly.</p>
</div>
</div>
<div class="sect3">
<h4 id="start-logging">5.2.8. Logging</h4>
<div class="paragraph">
<p>When running containers the standard output and standard error of the container can be printed out. Several options are available for configuring the log output:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 16. Logging configuration</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Element</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>enabled</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to <code>false</code> log output is disabled. This is useful if you want to disable log output by default but want to use the other configuration options when log output is switched on on the command line with <code>-Ddocker.showLogs</code>. Logging is enabled by default if a <code>&lt;log&gt;</code> section is given.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>prefix</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prefix to use for the log output in order to identify the container. By default the image <code>alias</code> is used or alternatively the container <code>id</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>date</strong></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Dateformat to use for log timestamps. If <code>&lt;date&gt;</code> is not given no timestamp will be shown. The date specification can be either a constant or a date format. The recognized constants are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>NONE</code> Switch off timestamp output. Useful on the command line
(<code>-Ddocker.logDate=NONE</code>) for switching off otherwise enabled
logging.</p>
</li>
<li>
<p><code>DEFAULT</code> A default format in the form <code>HH:mm:ss.SSS</code></p>
</li>
<li>
<p><code>MEDIUM</code> Joda medium date time format</p>
</li>
<li>
<p><code>SHORT</code> Joda short date time format</p>
</li>
<li>
<p><code>LONG</code> Joda long date time format</p>
</li>
<li>
<p><code>ISO8601</code> Full ISO-8601 formatted date time with milli seconds</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As an alternative a date-time format string as recognized by
<a href="http://joda-time.sourceforge.net/apidocs/org/joda/time/format/DateTimeFormat.html">JodaTime</a> is possible. In order to set a consistent date format the global configuration parameter <code>logDate</code> can be used.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>color</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Color used for coloring the prefix when coloring is enabeld (i.e. if running in a console and <code>useColor</code> is set). The available colors are <code>YELLOW</code>, <code>CYAN</code>, <code>MAGENTA</code>, <code>GREEN</code>, <code>RED</code>, <code>BLUE</code>. If coloring is enabled and now color is provided a color is picked for you.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>file</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path to a file to which the log output is written. This file is overwritten for every run and colors are switched off.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>driver</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Section which can specify a dedicated log driver to use. A <code>&lt;name&gt;</code> tag within this section depicts the logging driver with the options specified in <code>&lt;opts&gt;</code>. See the example below for how to use this.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;log&gt;</span>
  <span class="tag">&lt;prefix&gt;</span>TC<span class="tag">&lt;/prefix&gt;</span>
  <span class="tag">&lt;date&gt;</span>default<span class="tag">&lt;/date&gt;</span>
  <span class="tag">&lt;color&gt;</span>cyan<span class="tag">&lt;/color&gt;</span>
<span class="tag">&lt;/log&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example switches on the <code>gelf</code> <a href="https://docs.docker.com/engine/admin/logging/overview">logging driver</a> .
This is equivalent to the options <code>--log-driver=gelf --log-opt gelf-address=udp://localhost:12201</code> when using <code>docker run</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;log&gt;</span>
  ...
  <span class="tag">&lt;driver&gt;</span>
    <span class="tag">&lt;name&gt;</span>gelf<span class="tag">&lt;/name&gt;</span>
    <span class="tag">&lt;opts&gt;</span>
      <span class="tag">&lt;gelf-address&gt;</span>udp://localhost:12201<span class="tag">&lt;/gelf-address&gt;</span>
    <span class="tag">&lt;/opts&gt;</span>
  <span class="tag">&lt;/driver&gt;</span>
<span class="tag">&lt;/log&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="docker:stop">5.3. <strong>docker:stop</strong></h3>
<div class="paragraph">
<p>Stops and removes a docker container. This goals stops every container started with <code>&lt;docker:start&gt;</code> either during the same build (e.g. when bound to lifecycle phases when doing integration tests) or for containers created by a previous call to <code>&lt;docker:start&gt;</code></p>
</div>
<div class="paragraph">
<p>If called within the same build run, only the containers that were explicitly started during the run will be stopped. Existing containers started using <code>docker:start</code> for the project will not be affected.</p>
</div>
<div class="paragraph">
<p>If called as a separate invocation, the plugin will stop and remove any container it finds whose image is defined in the project&#8217;s configuration. Any existing containers found running whose image name matches but was not started by the plugin will not be affected.</p>
</div>
<div class="paragraph">
<p>In case the naming strategy for an image is <code>alias</code> (i.e. the container name is set to the given alias), then only the container with this alias is stopped. Other containers originating from the same image are not touched.</p>
</div>
<div class="paragraph">
<p>It should be noted that any containers created prior to version <code>0.13.7</code> of the plugin may not be stopped correctly by the plugin because the label needed to tie the container to the project may not exist. Should this happen, you will need to use the Docker CLI to clean up the containers and/or use the <code>docker.sledgehammer</code> option listed below.</p>
</div>
<div class="paragraph">
<p>For tuning what should happen when stopping there are four global parameters which are typically used as system properties:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 17. Stop configuration</caption>
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 71.4285%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Element</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>keepContainer</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to <code>true</code> not destroy container after they have been stopped. Default is false.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.keepContainer</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>keepRunning</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to <code>true</code> actually don&#8217;t stop the container. This apparently makes only sense when used on the command line when doing integration testing (i.e. calling <code>docker:stop</code> during a lifecycle binding) so that the container are still running after an integration test. This is useful for analysis of the containers (e.g. by entering it with <code>docker exec</code>).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.keepRunning</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>removeVolumes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to <code>true</code> will remove any volumes associated to the container as well. This option will be ignored if either <code>keepContainer</code> or <code>keepRunning</code> are true.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.removeVolumes</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>allContainers</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stops and removes any container that matches an image defined in the current project&#8217;s configuration. This was the default behavior of the plugin prior up to version 0.13.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.allContainers</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sh">$ mvn -Ddocker.keepRunning clean install</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="docker:push">5.4. <strong>docker:push</strong></h3>
<div class="paragraph">
<p>This goal uploads images to the registry which have a <code>&lt;build&gt;</code> configuration section. The images to push can be restricted with with
the global option <code>image</code> (see <a href="#global-configuration">Global Configuration</a> for details). The registry to push is by default <code>docker.io</code> but can be specified as part of the images&#8217;s <code>name</code> name the Docker way. E.g. <code>docker.test.org:5000/data:1.5</code> will push the image <code>data</code> with tag <code>1.5</code> to the registry <code>docker.test.org</code> at port <code>5000</code>. Security information (i.e. user and password) can be specified in multiple ways as described in section <a href="#authentication">Authentication</a>.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 18. Push options</caption>
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 71.4285%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Element</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Property</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>skipPush</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to <code>true</code> the plugin won&#8217;t push any images that have been built.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.skip.push</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>pushRegistry</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The registry to use when pushing the image. <a href="#registry">Registry Handling</a> for
more details.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.push.registry</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>retries</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">How often should a push be retried before giving up. This useful for flaky registries which tend to return 500 error codes from time to time. The default is 0 which means no retry at all.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.push.retries</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="docker:watch">5.5. <strong>docker:watch</strong></h3>
<div class="paragraph">
<p>When developing and testing applications you will often have to rebuild Docker images and restart containers. Typing <code>docker:build</code> and <code>docker:start</code> all the time is cumbersome. With <code>docker:watch</code> you can enable automatic rebuilding of images and restarting of containers in case of updates.</p>
</div>
<div class="paragraph">
<p><code>docker:watch</code> is the top-level goal which perform these tasks. There are two watch modes, which can be specified in multiple ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>build</code> : Automatically rebuild one or more Docker images when one of the files selected by an assembly changes. This works for all files included directly in <code>assembly.xml</code> but also for arbitrary dependencies.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sh">$ mvn package docker:build docker:watch -Ddocker.watchMode=build</code></pre>
</div>
</div>
<div class="paragraph">
<p>This mode works only when there is a <code>&lt;build&gt;</code> section in an image configuration. Otherwise no automatically build will be triggered for an image with only a <code>&lt;run&gt;</code> section. Note that you need the <code>package</code> phase to be executed before otherwise any artifact created by this build can not be included into the assembly. As described in the section about <code>docker:start</code> this is a Maven limitation.
* <code>run</code> : Automatically restart container when their associated images changes. This is useful if you pull a new version of an image externally or especially in combination with the <code>build</code> mode to restart containers when their image has been automatically rebuilt. This mode works reliably only when used together with <code>docker:start</code>.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sh">$ mvn docker:start docker:watch -Ddocker.watchMode=run</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>both</code> : Enables both <code>build</code> and <code>run</code>. This is the default.</p>
</li>
<li>
<p><code>none</code> : Image is completely ignored for watching.</p>
</li>
<li>
<p><code>copy</code> : Copy changed files into the running container. This is the fast way to update a container, however the target container must support hot deply, too so that it makes sense. Most application servers like Tomcat supports this.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The mode can also be <code>both</code> or <code>none</code> to select both or none of these variants, respectively. The default is <code>both</code>.</p>
</div>
<div class="paragraph">
<p><code>docker:watch</code> will run forever until it is interrupted with <code>CTRL-C</code> after which it will stop all containers. Depending on the configuration parameters <code>keepContainer</code> and <code>removeVolumes</code> the stopped containers with their volumes will be removed, too.</p>
</div>
<div class="paragraph">
<p>When an image is removed while watching it, error messages will be printed out periodically.  So don&#8217;t do that ;-)</p>
</div>
<div class="paragraph">
<p>Dynamically assigned ports stay stable in that they won&#8217;t change after a container has been stopped and a new container is created and started. The new container will try to allocate the same ports as the previous container.</p>
</div>
<div class="paragraph">
<p>If containers are linked together network or volume wise, and you update a container which other containers dependent on, the dependant containers are not restarted for now. E.g. when you have a "service" container accessing a "db" container and the "db" container is updated, then you "service" container will fail until it is restarted, too.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>A future version of this plugin will take care of restarting
these containers, too (in the right order), but for now you would have
to do this manually.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>This maven goal can be configured with the following top-level parameters:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 19. Watch configuration</caption>
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 71.4285%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Element</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Property</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>watchMode</strong></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Watch mode specifies what should be watched</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>build</code> : Watch changes in the assembly and rebuild the image in
case</p>
</li>
<li>
<p><code>run</code> : Watch a container&#8217;s image whether it changes and restart
the container in case</p>
</li>
<li>
<p><code>copy</code> : Changed files are copied into the container. The container can be either running or might be already exited (when used as a <em>data container</em> linked into a <em>platform container</em>). Requires Docker &gt;= 1.8.</p>
</li>
<li>
<p><code>both</code> : <code>build</code> and <code>run</code> combined</p>
</li>
<li>
<p><code>none</code> : Neither watching for builds nor images. This is useful if
you use prefactored images which won&#8217;t be changed and hence don&#8217;t
need any watching. <code>none</code> is best used on an per image level, see
below how this can be specified.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.watchMode</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>watchInterval</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interval in milliseconds how  often to check for changes, which must be larger than 100ms. The default is 5 seconds.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.watchInterval</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>watchPostGoal</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A maven goal which should be called if a rebuild or a restart has been performed. This goal must have the format <code>&lt;pluginGroupId&gt;:&lt;pluginArtifactId&gt;:&lt;goal&gt;</code> and the plugin must be configured in the <code>pom.xml</code>. For example a post-goal <code>io.fabric8:fabric8:delete-pods</code> will trigger the deletion of PODs in Kubernetes which in turn triggers are new start of a POD within the Kubernetes cluster. The value specified here is the the default post goal which can be overridden by <code>&lt;postGoal&gt;</code> in a <code>&lt;watch&gt;</code> configuration.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>watchPostExec</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A command which is executed within the container after files are copied into this container when <code>watchMode</code> is <code>copy</code>. Note that this container must be running.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>keepRunning</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to <code>true</code> all container will be kept running after <code>docker:watch</code> has been stopped. By default this is set to <code>false</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.keepRunning</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>keepContainer</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">As for <code>docker:stop</code>, if this is set to <code>true</code> (and <code>keepRunning</code> is disabled) then all container will be removed after they have been stopped. The default is <code>true</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.keepContainer</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>removeVolumes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if set to <code>true</code> will remove any volumes associated to the container as well. This option will be ignored if either <code>keepContainer</code> or <code>keepRunning</code> are <code>true</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>docker.removeVolumes</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Image specific watch configuration goes into an extra image-level <code>&lt;watch&gt;</code> section (i.e. <code>&lt;image&gt;&lt;watch&gt;...&lt;/watch&gt;&lt;/image&gt;</code>). The following parameters are recognized:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 20. Watch configuration for a single image</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Element</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>mode</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Each image can be configured for having individual watch mode. These take precedence of the global watch mode. The mode specified in this configuration takes precedence over the globally specified mode.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>interval</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Watch interval can be specified in milliseconds on image level. If given this will override the global watch interval.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>postGoal</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Post Maven plugin goal after a rebuild or restart. The value here must have the format <code>&lt;pluginGroupId&gt;:&lt;pluginArtifactId&gt;:&lt;goal&gt;</code> (e.g. <code>io.fabric8:fabric8:delete-pods</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>postExec</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Command to execute after files are copied into a
running container when <code>mode</code> is <code>copy</code>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Here is an example how the watch mode can be tuned:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;configuration&gt;</span>
   <span class="comment">&lt;!-- Check every 10 seconds by default --&gt;</span>
   <span class="tag">&lt;watchInterval&gt;</span>10000<span class="tag">&lt;/watchInterval&gt;</span>
   <span class="comment">&lt;!-- Watch for doing rebuilds and restarts --&gt;</span>
   <span class="tag">&lt;watchMode&gt;</span>both<span class="tag">&lt;/watch&gt;</span>
   <span class="tag">&lt;images&gt;</span>
      <span class="tag">&lt;image&gt;</span>
         <span class="comment">&lt;!-- Service checks every 5 seconds --&gt;</span>
         <span class="tag">&lt;alias&gt;</span>service<span class="tag">&lt;/alias&gt;</span>
         ....
         <span class="tag">&lt;watch&gt;</span>
            <span class="tag">&lt;interval&gt;</span>5000<span class="tag">&lt;/interval&gt;</span>
         <span class="tag">&lt;/watch&gt;</span>
      <span class="tag">&lt;/image&gt;</span>
      <span class="tag">&lt;image&gt;</span>
         <span class="comment">&lt;!-- Database needs no watching --&gt;</span>
         <span class="tag">&lt;alias&gt;</span>db<span class="tag">&lt;alias&gt;</span>
         ....
         <span class="tag">&lt;watch&gt;</span>
            <span class="tag">&lt;mode&gt;</span>none<span class="tag">&lt;/mode&gt;</span>
         <span class="tag">&lt;/watch&gt;</span>
      <span class="tag">&lt;/image&gt;</span>
      ....
   <span class="tag">&lt;/images&gt;</span>
<span class="tag">&lt;/configuration&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Given this configuration</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sh">mvn package docker:build docker:start docker:watch</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can build the service image, start up all containers and go into a watch loop. Again, you need the <code>package</code> phase in order that the assembly can find the artifact build by this project. This is a Maven limitation. The <code>db</code> image will never be watch since it assumed to not change while watching.</p>
</div>
</div>
<div class="sect2">
<h3 id="docker:remove">5.6. <strong>docker:remove</strong></h3>
<div class="paragraph">
<p>This goal can be used to clean up images and containers. By default all so called <em>data images</em> are removed with its containers. A data image is an image without a run configuration. This can be tuned by providing the properties <code>removeAll</code> which indicates to remove all images managed by this build. As with the other goals, the configuration <code>image</code> can be used to tune the images to remove. All containers belonging to the images are removed as well.</p>
</div>
<div class="paragraph">
<p>Considering three images 'db','tomcat' and 'data' where 'data' is the only data images this example demonstrates the effect of this goal:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>mvn docker:remove</code> will remove 'data'</p>
</li>
<li>
<p><code>mvn -Ddocker.removeAll docker:remove</code> will remove all three images</p>
</li>
<li>
<p><code>mvn -Ddocker.image=data,tomcat docker:remove</code> will remove 'data'</p>
</li>
<li>
<p><code>mvn -Ddocker.image=data,tomcat -Ddocker.removeAll docker:remove</code> will remove 'data' and 'tomcat'</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="docker:logs">5.7. <strong>docker:logs</strong></h3>
<div class="paragraph">
<p>With this goal it is possible to print out the logs of containers
started from images configured in this plugin. By default only the
latest container started is printed, but this can be changed with a
property. The format of the log output is influenced by run
configuration of the configured images. The following system
properties can the behaviour of this goal:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 21. Logging options</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.logAll</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to <code>true</code> the logs of all containers created from images configured for this plugin are printed. The container id is then prefixed before every log line. These images can contain many containers which are already stopped. It is probably a better idea to use <code>docker logs</code> diretly from the command line.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.follow</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If given will wait for subsequent log output until CRTL-C is pressed. This is similar to the behaviour of <code>docker logs -f</code> (or <code>tail -f</code>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.image</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Filte to restrict the set of images for which log should be fetched. This can be a comma separated list of image or alias names.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.logDate</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date format to use. See "<a href="#start-logging">Logging</a>" for available formats.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sh">$ mvn docker:logs -Ddocker.follow -Ddocker.logDate=DEFAULT</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="docker:source">5.8. <strong>docker:source</strong></h3>
<div class="paragraph">
<p>The <code>docker:source</code> target can be used to attach a docker build archive containing the Dockerfile and all added files to the Maven
project with a certain classifier. It reuses the configuration from <a href="docker-build.md">docker:build</a>.</p>
</div>
<div class="paragraph">
<p><code>docker:source</code> uses the image&#8217;s <a href="image-configuration.md">alias</a> as part of the classifier, so it is mandatory that the alias is set for
this goal to work. The classifier is calculated as <code>docker-&lt;alias&gt;</code> so when the alias is set to <code>service</code>, then the classifier is <code>docker-service</code>.</p>
</div>
<div class="paragraph">
<p><code>docker:source</code> can be attached to a Maven execution phase, which is <code>generate-sources</code> by default.</p>
</div>
<div class="paragraph">
<p>For example, this configuration will attach the docker build archive to the artifacts to store in the repository:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;plugin&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>docker-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
  <span class="comment">&lt;!-- ..... --&gt;</span>
  <span class="tag">&lt;executions&gt;</span>
     <span class="tag">&lt;execution&gt;</span>
       <span class="tag">&lt;id&gt;</span>sources<span class="tag">&lt;/id&gt;</span>
       <span class="tag">&lt;goals&gt;</span>
         <span class="tag">&lt;goal&gt;</span>source<span class="tag">&lt;/goal&gt;</span>
       <span class="tag">&lt;/goals&gt;</span>
     <span class="tag">&lt;/execution&gt;</span>
  <span class="tag">&lt;/executions&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If the plugin is not bound to an execute phase but called directly, it must be ensured that the package phase is called, too. That is required to find the artifacts created with this build when referenced from an assembly.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="external-configuration">6. External Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For special configuration needs there is the possibility to get the
runtime and build configuration from places outside the plugin&#8217;s
configuration. This is done with the help of <code>&lt;external&gt;</code>
configuration sections which at least has a <code>&lt;type&gt;</code> subelement. This
<code>&lt;type&gt;</code> element selects a specific so called "handler" which is
responsible for creating the full image configuration. A handler can
decided to use the <code>&lt;run&gt;</code> and <code>&lt;build&gt;</code> configuration which could
be provided in addition to this <code>&lt;external&gt;</code> section or it can decide
to completely ignore any extra configuration option.</p>
</div>
<div class="paragraph">
<p>A handler can also decide to expand this single image configuration to
a list of image configurations. The image configurations resulting
from such a external configuration are added to the <em>regular</em>
<code>&lt;image&gt;</code> configurations without an <code>&lt;external&gt;</code> section.</p>
</div>
<div class="paragraph">
<p>The available handlers are described in the following.</p>
</div>
<div class="sect2">
<h3 id="property-configuration">6.1. Property based configuration</h3>
<div class="paragraph">
<p>For simple needs the image configuration can be completely defined via
Maven properties which are defined outside of this plugin&#8217;s
configuration. Such a property based configuration can be selected
with an <code>&lt;type&gt;</code> of <code>props</code>. As extra configuration a prefix for the
properties can be defined which by default is <code>docker</code>.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;image&gt;</span>
  <span class="tag">&lt;external&gt;</span>
     <span class="tag">&lt;type&gt;</span>props<span class="tag">&lt;/type&gt;</span>
     <span class="tag">&lt;prefix&gt;</span>docker<span class="tag">&lt;/prefix&gt;</span> <span class="comment">&lt;!-- this is the default --&gt;</span>
  <span class="tag">&lt;/external&gt;</span>
<span class="tag">&lt;/image&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Given this example configuration a single image configuration is built
up from the following properties, which correspond to the corresponding
values in the <code>&lt;build&gt;</code> and <code>&lt;run&gt;</code> sections.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 22. External properties</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.alias</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alias name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.args.BUILDVAR</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set the value of a build variable. The syntax is the same as for specifying environment variables (see below).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.assembly.baseDir</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directory name for the exported artifacts as described in an assembly (which is <code>/maven</code> by default).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.assembly.descriptor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path to the assembly descriptor when building an image</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.assembly.descriptorRef</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of a predefined assembly to use.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.assembly.exportBaseDir</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code> export base directory</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.assembly.ignorePermissions</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to <code>true</code> existing file permissions are ignored when creating the assembly archive. Deprecated, use a permission mode of <code>ignore</code> instead.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.assembly.permissions</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">can be <code>ignore</code> to use the permission as found on files regardless on any assembly configuration, <code>keep</code> to respect the assembly provided permissions, <code>exec</code> for setting the executable bit on all files (required for Windows when using an assembly mode <code>dir</code>) or <code>auto</code> to let the plugin select <code>exec</code> on Windows and <code>keep</code> on others. <code>keep</code> is the default value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.assembly.dockerFileDir</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">specifies a directory containing an external Dockerfile that will be used to create the image. This is deprecated p ease use <code>docker.dockerFileDir</code> or <code>docker.dockerFile</code> instead.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.nocache</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Don&#8217;t use Docker&#8217;s build cache.This can be overwritten by setting a system property <code>docker.nocache</code> when running Maven.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.bind.idx</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets a list of paths to bind/expose in the container</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.capAdd.idx</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of kernel capabilities to add to the container</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.capDrop.idx</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of kernel capabilities to remove from the container</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.cleanup</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cleanup dangling (untagged) images after each build (including any containers created from them). Default is <code>try</code> (which wont fail the build if removing fails), other possible values are <code>none</code> (no cleanup) or <code>remove</code> (remove but fail if unsuccessful)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.cmd</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Command to execute. This is used both when running a container and as default command when creating an image.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.domainname</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Container domain name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.dns.idx</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of dns servers to use</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.dnsSearch.idx</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of dns search domains</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.dockerFile</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">specifies a Dockerfile to use. This property must point to the Dockerfile itself.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.dockerFileDir</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">specifies a directory containing an external dockerfile that will be used to create the image. The dockerfile must be name <code>Dockerfile</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.entrypoint</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Container entry point</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.workdir</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Container working directory</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.env.VARIABLE</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets an environment variable. E.g. <code>&lt;docker.env.JAVA_OPTS&gt;-Xmx512m&lt;/docker.env.JAVA_OPTS&gt;</code> sets the environment variable <code>JAVA_OPTS</code>. Multiple such entries can be provided. This environment is used both for building images and running containers. The value cannot be empty but can contain Maven property names which are resolved before the Dockerfile is created</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.envPropertyFile</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">specifies the path to a property file whose properties are used as environment variables. The environment variables takes precedence over any other environment variables specified.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.extraHosts.idx</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of <code>host:ip</code> to add to <code>/etc/hosts</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.from</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Base image for building an image</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.hostname</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Container hostname</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.labels.LABEL</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets a label which works similarly like setting environment variables.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.log.enabled</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use logging (default: <code>true</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.log.prefix</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Output prefix</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.log.color</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ANSI color to use for the prefix</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.log.date</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date format for printing the timestamp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.log.driver.name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of an alternative log driver</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.log.dirver.opts.VARIABLE</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logging driver options (specified similar as in <code>docker.env.VARIABLE</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.links.idx</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">defines a list of links to other containers when starting a container. <em>idx</em> can be any suffix which is not use except when <em>idx</em> is numeric it specifies the order within the list (i.e. the list contains first a entries with numeric indexes sorted and the all non-numeric indexes in arbitrary order). For example <code>&lt;docker.links.1&gt;db&lt;/docker.links.1&gt;</code> specifies a link to the image with alias 'db'.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.maintainer</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">defines the maintainer&#8217;s email as used when building an image</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.memory</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Container memory (in bytes)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.memorySwap</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total memory (swap + memory) <code>-1</code> to disable swap</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Image name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.namingStrategy</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Container naming (either <code>none</code> or <code>alias</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.optimise</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if set to true then it will compress all the <code>runCmds</code> into a single RUN directive so that only one image layer is created.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.portPropertyFile</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">specifies a path to a port mapping used when starting a container.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.ports.idx</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets a port mapping. For example <code>&lt;docker.ports.1&gt;jolokia.ports:8080&lt;docker.ports.1&gt;</code> maps the container port 8080 dynamically to a host port and assigns this host port to the Maven property <code>${jolokia.port}</code>. See <a href="#_port-mapping">Port mapping</a> for possible mapping options. When creating images images only the right most port is used for exposing the port. For providing multiple port mappings, the index should be count up.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.registry</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Registry to use for pushing images.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.restartPolicy.name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Container restart policy</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.restartPolicy.retry</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Max restrart retries if <code>on-failure</code> used</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.tags.idx</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">defines a list of tags to apply to a built image</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.ulimits.idx</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ulimits for the container. Ulimit is specified with a soft and hard limit <code>&lt;type&gt;=&lt;soft limit&gt;[:&lt;hard limit&gt;]</code>. For example <code>docker.ulimits.1=memlock=-1:-1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.user</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User to switch to at the end of a Dockerfile. Not to confuse with <code>docker.username</code> which is used for authentication when interacting with a Docker registry.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.volumes.idx</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">defines a list of volumes to expose when building an image</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.volumesFrom.idx</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">defines a list of image aliases from which the volumes should be mounted of the container. The list semantics is the same as for links (see above). For examples <code>&lt;docker.volumesFrom.1&gt;data&lt;/docker.volumesFrom.1&gt;</code> will mount all volumes exported by the <code>data</code> image.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.wait.http.url</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL to wait for during startup of a container</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.wait.http.method</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP method to use for ping check</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.wait.http.status</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Status code to wait for when doing HTTP ping check</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.wait.time</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Amount of time to wait during startup of a container (in ms)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.wait.log</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Wait for a log output to appear.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.wait.exec.postStart</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Command to execute after the container has start up.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.wait.exec.preStop</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Command to execute before command stops.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.wait.shutdown</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time in milliseconds to wait between stopping a container and removing it.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.wait.tcp.mode</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Either <code>mapped</code> or <code>direct</code> when waiting on TCP connections</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.wait.tcp.host</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hostname to use for a TCP wait checks</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.wait.tcp.port.idx</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of ports to use for a TCP check.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.wait.kill</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time in milliseconds to wait between sending SIGTERM and SIGKILL to a container when stopping it.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>docker.workingDir</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Working dir for commands to run in</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Any other <code>&lt;run&gt;</code> or <code>&lt;build&gt;</code> sections are ignored when this handler
is used. Multiple property configuration handlers can be used if they
use different prefixes. As stated above the environment and ports
configuration are both used for running container and building
images. If you need a separate configuration you should use explicit
run and build configuration sections.</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;properties&gt;</span>
  <span class="tag">&lt;docker.name&gt;</span>jolokia/demo<span class="tag">&lt;/docker.name&gt;</span>
  <span class="tag">&lt;docker.alias&gt;</span>service<span class="tag">&lt;/docker.alias&gt;</span>
  <span class="tag">&lt;docker.from&gt;</span>consol/tomcat:7.0<span class="tag">&lt;/docker.from&gt;</span>
  <span class="tag">&lt;docker.assembly.descriptor&gt;</span>src/main/docker-assembly.xml<span class="tag">&lt;/docker.assembly.descriptor&gt;</span>
  <span class="tag">&lt;docker.env.CATALINA_OPTS&gt;</span>-Xmx32m<span class="tag">&lt;/docker.env.CATALINA_OPTS&gt;</span>
  <span class="tag">&lt;docker.label.version&gt;</span>${project.version}<span class="tag">&lt;/docker.label.version&gt;</span>
  <span class="tag">&lt;docker.ports.jolokia.port&gt;</span>8080<span class="tag">&lt;/docker.ports.jolokia.port&gt;</span>
  <span class="tag">&lt;docker.wait.url&gt;</span>http://localhost:${jolokia.port}/jolokia<span class="tag">&lt;/docker.wait.url&gt;</span>
<span class="tag">&lt;/properties&gt;</span>

<span class="tag">&lt;build&gt;</span>
  <span class="tag">&lt;plugins&gt;</span>
    <span class="tag">&lt;plugin&gt;</span>
      <span class="tag">&lt;groupId&gt;</span>io.fabric8<span class="tag">&lt;/groupId&gt;</span>
      <span class="tag">&lt;artifactId&gt;</span>docker-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
      <span class="tag">&lt;configuration&gt;</span>
        <span class="tag">&lt;images&gt;</span>
          <span class="tag">&lt;image&gt;</span>
            <span class="tag">&lt;external&gt;</span>
              <span class="tag">&lt;type&gt;</span>props<span class="tag">&lt;/type&gt;</span>
              <span class="tag">&lt;prefix&gt;</span>docker<span class="tag">&lt;/prefix&gt;</span>
            <span class="tag">&lt;/external&gt;</span>
          <span class="tag">&lt;/image&gt;</span>
        <span class="tag">&lt;/images&gt;</span>
      <span class="tag">&lt;/configuration&gt;</span>
    <span class="tag">&lt;/plugin&gt;</span>
  <span class="tag">&lt;/plugins&gt;</span>
<span class="tag">&lt;/build&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="registry">7. Registry handling</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Docker uses registries to store images. The registry is typically
specified as part of the name. I.e. if the first part (everything
before the first <code>/</code>) contains a dot (<code>.</code>) or colon (<code>:</code>) this part is
interpreted as an address (with an optionally port) of a remote
registry. This registry (or the default <code>docker.io</code> if no
registry is given) is used during push and pull operations. This
plugin follows the same semantics, so if an image name is specified
with a registry part, this registry is contacted. Authentication is
explained in the next <a href="#_authentication">section</a>.</p>
</div>
<div class="paragraph">
<p>There are some situations however where you want to have more
flexibility for specifying a remote registry. This might be, because
you do not want to hard code a registry into <code>pom.xml</code> but
provide it from the outside with an environment variable or a system
property.</p>
</div>
<div class="paragraph">
<p>This plugin supports various ways of specifying a registry:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the image name contains a registry part, this registry is used
unconditionally and can not be overwritten from the outside.</p>
</li>
<li>
<p>If an image name doesn&#8217;t contain a registry, then by default the
default Docker registry <code>docker.io</code> is used for push and pull
operations. But this can be overwritten through various means:</p>
<div class="ulist">
<ul>
<li>
<p>If the <code>&lt;image&gt;</code> configuration contains a <code>&lt;registry&gt;</code> subelement
this registry is used.</p>
</li>
<li>
<p>Otherwise, a global configuration element <code>&lt;registry&gt;</code> is
evaluated which can be also provided as system property via
<code>-Ddocker.registry</code>.</p>
</li>
<li>
<p>Finally an environment variable <code>DOCKER_REGISTRY</code> is looked up for
detecting a registry.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This registry is used for pulling (i.e. for autopull the base image
when doing a <code>docker:build</code>) and pushing with <code>docker.push</code>. However,
when these two goals a are combined on the command line like in <code>mvn
-Ddocker.registry=myregistry:5000 package docker:build docker:push</code>
the same registry is used for both operation. For a more fine grained
control, separate registries for <em>pull</em> and <em>push</em> can be specified.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the plugin&#8217;s configuration with the parameters <code>&lt;pullRegistry&gt;</code> and
<code>&lt;pushRegistry&gt;</code>, respectively.</p>
</li>
<li>
<p>With the system properties <code>docker.pull.registry</code> and
<code>docker.push.registry</code>, respectively.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;configuration&gt;</span>
  <span class="tag">&lt;registry&gt;</span>docker.jolokia.org:443<span class="tag">&lt;/registry&gt;</span>
  <span class="tag">&lt;images&gt;</span>
    <span class="tag">&lt;image&gt;</span>
      <span class="comment">&lt;!-- Without an explicit registry ... --&gt;</span>
      <span class="tag">&lt;name&gt;</span>jolokia/jolokia-java<span class="tag">&lt;/name&gt;</span>
      <span class="comment">&lt;!-- ... hence use this registry --&gt;</span>
      <span class="tag">&lt;registry&gt;</span>docker.ro14nd.de<span class="tag">&lt;/registry&gt;</span>
      ....
    <span class="tag">&lt;image&gt;</span>
    <span class="tag">&lt;image&gt;</span>
      <span class="tag">&lt;name&gt;</span>postgresql<span class="tag">&lt;/name&gt;</span>
      <span class="comment">&lt;!-- No registry in the name, hence use the globally
           configured docker.jolokia.org:443 as registry --&gt;</span>
      ....
    <span class="tag">&lt;/image&gt;</span>
    <span class="tag">&lt;image&gt;</span>
      <span class="comment">&lt;!-- Explicitely specified always wins --&gt;</span>
      <span class="tag">&lt;name&gt;</span>docker.example.com:5000/another/server<span class="tag">&lt;/name&gt;</span>
    <span class="tag">&lt;/image&gt;</span>
  <span class="tag">&lt;/images&gt;</span>
<span class="tag">&lt;/configuration&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>There is some special behaviour when using an externally provided
registry like described above:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When <em>pulling</em>, the image pulled will be also tagged with a repository
name <strong>without</strong> registry. The reasoning behind this is that this
image then can be referenced also by the configuration when the
registry is not specified anymore explicitly.</p>
</li>
<li>
<p>When <em>pushing</em> a local image, temporarily a tag including the
registry is added and removed after the push. This is required
because Docker can only push registry-named images.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="authentication">8. Authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When pulling (via the <code>autoPull</code> mode of <code>docker:start</code>) or pushing image, it
might be necessary to authenticate against a Docker registry.</p>
</div>
<div class="paragraph">
<p>There are three different ways for providing credentials:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using a <code>&lt;authConfig&gt;</code> section in the plugin configuration with
<code>&lt;username&gt;</code> and <code>&lt;password&gt;</code> elements.</p>
</li>
<li>
<p>Providing system properties <code>docker.username</code> and <code>docker.password</code>
from the outside</p>
</li>
<li>
<p>Using a <code>&lt;server&gt;</code> configuration in <code>~/.m2/settings.xml</code></p>
</li>
<li>
<p>Login into a registry with <code>docker login</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Using the username and password directly in the <code>pom.xml</code> is not
recommended since this is widely visible. This is most easiest and
transparent way, though. Using an <code>&lt;authConfig&gt;</code> is straight forward:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;plugin&gt;</span>
  <span class="tag">&lt;configuration&gt;</span>
    <span class="tag">&lt;image&gt;</span>consol/tomcat-7.0<span class="tag">&lt;/image&gt;</span>
    ...
    <span class="tag">&lt;authConfig&gt;</span>
      <span class="tag">&lt;username&gt;</span>jolokia<span class="tag">&lt;/username&gt;</span>
      <span class="tag">&lt;password&gt;</span>s!cr!t<span class="tag">&lt;/password&gt;</span>
    <span class="tag">&lt;/authConfig&gt;</span>
  <span class="tag">&lt;/configuration&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The system property provided credentials are a good compromise when
using CI servers like Jenkins. You simply provide the credentials from
the outside:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sh">mvn -Ddocker.username=jolokia -Ddocker.password=s!cr!t docker:push</code></pre>
</div>
</div>
<div class="paragraph">
<p>The most secure and also the most <em>mavenish</em> way is to add a server to
the Maven settings file <code>~/.m2/settings.xml</code>:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;servers&gt;</span>
  <span class="tag">&lt;server&gt;</span>
    <span class="tag">&lt;id&gt;</span>docker.io<span class="tag">&lt;/id&gt;</span>
    <span class="tag">&lt;username&gt;</span>jolokia<span class="tag">&lt;/username&gt;</span>
    <span class="tag">&lt;password&gt;</span>s!cr!t<span class="tag">&lt;/password&gt;</span>
  <span class="tag">&lt;/server&gt;</span>
  ....
<span class="tag">&lt;/servers&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The server id must specify the registry to push to/pull from, which by
default is central index <code>docker.io</code> (or <code>index.docker.io</code> / <code>registry.hub.docker.com</code> as fallbacks).
Here you should add your docker.io account for your repositories. If you have multiple accounts
for the same registry, the second user can be specified as part of the ID. In the example above, if you
have a second accorunt 'fabric8io' then use an <code>&lt;id&gt;docker.io/fabric8io&lt;/id&gt;</code> for this second entry. I.e. add the
username with a slash to the id name. The default without username is only taken if no server entry with
a username appended id is chosen.</p>
</div>
<div class="paragraph">
<p>As a final fallback, this plugin consults <code>~/.docker/config.json</code> for getting to the credentials. Within this
file credentials are stored when connecting to a registry with the command <code>docker login</code> from the command line.</p>
</div>
<div class="sect2">
<h3 id="pull-vs-push-authentication">8.1. Pull vs. Push Authentication</h3>
<div class="paragraph">
<p>The credentials lookup described above is valid for both push and
pull operations. In order to narrow things down, credentials can be be
provided for pull or push operations alone:</p>
</div>
<div class="paragraph">
<p>In an <code>&lt;authConfig&gt;</code> section a sub-section <code>&lt;pull&gt;</code> and/or <code>&lt;push&gt;</code>
can be added. In the example below the credentials provider are only
used for image push operations:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;plugin&gt;</span>
  <span class="tag">&lt;configuration&gt;</span>
    <span class="tag">&lt;image&gt;</span>consol/tomcat-7.0<span class="tag">&lt;/image&gt;</span>
    ...
    <span class="tag">&lt;authConfig&gt;</span>
      <span class="tag">&lt;push&gt;</span>
         <span class="tag">&lt;username&gt;</span>jolokia<span class="tag">&lt;/username&gt;</span>
         <span class="tag">&lt;password&gt;</span>s!cr!t<span class="tag">&lt;/password&gt;</span>
      <span class="tag">&lt;/push&gt;</span>
    <span class="tag">&lt;/authConfig&gt;</span>
  <span class="tag">&lt;/configuration&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When the credentials are given on the command line as system
properties, then the properties <code>docker.pull.username</code> /
<code>docker.pull.password</code> and <code>docker.push.username</code> /
<code>docker.push.password</code> are used for pull and push operations,
respectively (when given). Either way, the standard lookup algorithm
as described in the previous section is used as fallback.</p>
</div>
</div>
<div class="sect2">
<h3 id="openshift-authentication">8.2. OpenShift Authentication</h3>
<div class="paragraph">
<p>When working with the default registry in OpenShift, the credentials
to authtenticate are the OpenShift username and access token. So, a
typical interaction with the OpenShift registry from the outside is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>oc login
...
mvn -Ddocker.registry=docker-registry.domain.com:80/default/myimage \
    -Ddocker.username=$(oc whoami) \
    -Ddocker.password=$(oc whoami -t)</pre>
</div>
</div>
<div class="paragraph">
<p>(note, that the image&#8217;s user name part ("default" here") must
correspond to an OpenShift project with the same name to which you
currently connected account has access).</p>
</div>
<div class="paragraph">
<p>This can be simplified by using the system property
<code>docker.useOpenShiftAuth</code> in which case the plugin does the
lookup. The equivalent to the example above is</p>
</div>
<div class="listingblock">
<div class="content">
<pre>oc login
...
mvn -Ddocker.registry=docker-registry.domain.com:80/default/myimage \
    -Ddocker.useOpenShiftAuth</pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively the configuration option <code>&lt;useOpenShiftAuth&gt;</code> can be
added to the <code>&lt;authConfig&gt;</code> section.</p>
</div>
<div class="paragraph">
<p>For dedicted <em>pull</em> and <em>push</em> configuration the system properties
<code>docker.pull.useOpenShiftAuth</code> and <code>docker.push.useOpenShiftAuth</code> are
available as well as the configuration option <code>&lt;useOpenShiftAuth&gt;</code> in
an <code>&lt;pull&gt;</code> or <code>&lt;push&gt;</code> section within the <code>&lt;authConfig&gt;</code>
configuration.</p>
</div>
</div>
<div class="sect2">
<h3 id="password-encryption">8.3. Password encryption</h3>
<div class="paragraph">
<p>Regardless which mode you choose you can encrypt password as described
in the
<a href="http://maven.apache.org/guides/mini/guide-encryption.html">Maven documentation</a>. Assuming
that you have setup a <em>master password</em> in
<code>~/.m2/security-settings.xml</code> you can create easily encrypted
passwords:</p>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ mvn --encrypt-password
Password:
{QJ6wvuEfacMHklqsmrtrn1/ClOLqLm8hB7yUL23KOKo=}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This password then can be used in <code>authConfig</code>, <code>docker.password</code>
and/or the <code>&lt;server&gt;</code> setting configuration. However, putting an
encrypted password into <code>authConfig</code> in the <code>pom.xml</code> doesn&#8217;t make
much sense, since this password is encrypted with an individual master
password.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="further-reading">9. Further reading</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Examples:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fabric8io/docker-maven-plugin/blob/master/doc/examples.md">Examples</a>
are below <code>samples/</code> and contain example
setups which you can use as blueprints for your own projects.</p>
</li>
<li>
<p>A <a href="https://github.com/fabric8io/shootout-docker-maven">Shootout</a> for
comparing docker maven plugins</p>
</li>
<li>
<p>Another
<a href="https://github.com/fabric8io/docker-maven-sample">sample project</a>
with a Microservice and a Database.</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://github.com/fabric8io/docker-maven-plugin/blob/master/doc/changelog.md">ChangeLog</a>
has the release history of this plugin.</p>
</li>
<li>
<p><a href="https://github.com/fabric8io/docker-maven-plugin/blob/master/doc/contributing.md">Contributing</a>
explains how you can contribute to this project. Pull requests are highly appreciated!</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 0.15-SNAPSHOT<br>
Last updated 2016-07-23 09:21:05 UTC
</div>
</div>
</body>
</html>