<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>External Configuration | docker-maven-plugin</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.4.3">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-edit-link/plugin.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-anchors/plugin.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-code_tomorrow_scheme/code-tomorrow-scheme.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
    

        
    
    
    <link rel="next" href="./registry-handling.html" />
    
    
    <link rel="prev" href="./docker-logs.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="5" data-basepath="." data-revision="Fri Oct 16 2015 10:14:46 GMT+0000 (UTC)">
    

<div class="book-summary">
    <div class="book-search" role="search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="installation.html">
            
                
                    <a href="./installation.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Installation
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="global-configuration.html">
            
                
                    <a href="./global-configuration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Global Configuration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="image-configuration.html">
            
                
                    <a href="./image-configuration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Image Configuration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="goals.html">
            
                
                    <a href="./goals.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Maven Goals
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="docker-build.html">
            
                
                    <a href="./docker-build.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        docker:build
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="docker-start.html">
            
                
                    <a href="./docker-start.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        docker:start
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="docker-stop.html">
            
                
                    <a href="./docker-stop.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                        docker:stop
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="docker-watch.html">
            
                
                    <a href="./docker-watch.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                        docker:watch
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="docker-push.html">
            
                
                    <a href="./docker-push.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                        docker:push
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="docker-remove.html">
            
                
                    <a href="./docker-remove.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.6.</b>
                        
                        docker:remove
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.7" data-path="docker-logs.html">
            
                
                    <a href="./docker-logs.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.7.</b>
                        
                        docker:logs
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="5" data-path="external-configuration.html">
            
                
                    <a href="./external-configuration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        External Configuration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6" data-path="registry-handling.html">
            
                
                    <a href="./registry-handling.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        Registry Handling
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="authentication.html">
            
                
                    <a href="./authentication.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        Authentication
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="links.html">
            
                
                    <a href="./links.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        Further Reading
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    
    


    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >docker-maven-plugin</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <a id="edit-link" href="https://github.com/rhuss/docker-maven-plugin/edit/master/doc/manual/external-configuration.md" class="btn fa fa-edit pull-left">&#xA0;&#xA0;Edit This Page</a><h2 id="external-configuration"><a name="external-configuration" class="plugin-anchor" href="#external-configuration"><span class="fa fa-link"></span></a>External Configuration</h2>
<p>For special configuration needs there is the possibility to get the
runtime and build configuration from places outside the plugin&apos;s
configuration. This is done with the help of <code>&lt;external&gt;</code>
configuration sections which at least has a <code>&lt;type&gt;</code> subelement. This
<code>&lt;type&gt;</code> element selects a specific so called &quot;handler&quot; which is
responsible for creating the full image configuration. A handler can
decided to use the <code>&lt;run&gt;</code> and <code>&lt;build&gt;</code> configuration which could
be provided in addition to this <code>&lt;external&gt;</code> section or it can decide
to completely ignore any extra configuration option. </p>
<p>A handler can also decide to expand this single image configuration to
a list of image configurations. The image configurations resulting
from such a external configuration are added to the <em>regular</em>
<code>&lt;image&gt;</code> configurations without an <code>&lt;external&gt;</code> section.</p>
<p>The available handlers are described in the following. </p>
<h4 id="property-based-configuration"><a name="property-based-configuration" class="plugin-anchor" href="#property-based-configuration"><span class="fa fa-link"></span></a>Property based Configuration</h4>
<p>For simple needs the image configuration can be completely defined via
Maven properties which are defined outside of this plugin&apos;s
configuration. Such a property based configuration can be selected
with an <code>&lt;type&gt;</code> of <code>props</code>. As extra configuration a prefix for the
properties can be defined which by default is <code>docker</code>.</p>
<p>Example:</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">image</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">external</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-title">type</span>&gt;</span>props<span class="hljs-tag">&lt;/<span class="hljs-title">type</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-title">prefix</span>&gt;</span>docker<span class="hljs-tag">&lt;/<span class="hljs-title">prefix</span>&gt;</span> <span class="hljs-comment">&lt;!-- this is the default --&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">external</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">image</span>&gt;</span>
</code></pre>
<p>Given this example configuration a single image configuration is build
up from the following properties, which correspond to corresponding
values in the <code>&lt;build&gt;</code> and <code>&lt;run&gt;</code> sections.</p>
<ul>
<li><strong>docker.alias</strong> Alias name</li>
<li><strong>docker.assembly.baseDir</strong> Directory name for the exported artifacts as
described in an assembly (which is <code>/maven</code> by default).</li>
<li><strong>docker.assembly.descriptor</strong> Path to the assembly descriptor when
building an image</li>
<li><strong>docker.assembly.descriptorRef</strong> Name of a predefined assembly to
use. </li>
<li><strong>docker.assembly.exportBaseDir</strong> If <code>true</code> export base directory</li>
<li><strong>docker.assembly.ignorePermissions</strong> If set to <code>true</code> existing file permissions are ignored
when creating the assembly archive</li>
<li><strong>docker.assembly.dockerFileDir</strong> specifies a directory containing an external Dockerfile
that will be used to create the image</li>
<li><strong>docker.bind.idx</strong> Sets a list of paths to bind/expose in the container</li>
<li><strong>docker.capAdd.idx</strong> List of kernel capabilities to add to the container</li>
<li><strong>docker.capDrop.idx</strong> List of kernel capabilities to remove from the container</li>
<li><strong>docker.cmd</strong> Command to execute. This is used both when
running a container and as default command when creating an image.</li>
<li><strong>docker.domainname</strong> Container domain name</li>
<li><strong>docker.dns.idx</strong> List of dns servers to use</li>
<li><strong>docker.dnsSearch.idx</strong> List of dns search domains</li>
<li><strong>docker.entrypoint</strong> Container entry point</li>
<li><strong>docker.workdir</strong> Container working directory</li>
<li><strong>docker.env.VARIABLE</strong> Sets an environment
variable. E.g. <code>&lt;docker.env.JAVA_OPTS&gt;-Xmx512m&lt;/docker.env.JAVA_OPTS&gt;</code>
sets the environment variable <code>JAVA_OPTS</code>. Multiple such entries can
be provided. This environment is used both for building images and
running containers. The value cannot be empty but can contain Maven property names which are
resolved before the Dockerfile is created</li>
<li><strong>docker.labels.LABEL</strong> Sets a label which works similarly like setting environment variables. </li>
<li><strong>docker.envPropertyFile</strong> specifies the path to a property file whose properties are 
used as environment variables. The environment variables takes precedence over any other environment
variables specified.</li>
<li><strong>docker.extraHosts.idx</strong> List of <code>host:ip</code> to add to <code>/etc/hosts</code></li>
<li><strong>docker.from</strong> Base image for building an image</li>
<li><strong>docker.hostname</strong> Container hostname</li>
<li><strong>docker.links.idx</strong> defines a list of links to other containers when
starting a container. <em>idx</em> can be any suffix which is not use
except when <em>idx</em> is numeric it specifies the order within the
list (i.e. the list contains first a entries with numeric
indexes sorted and the all non-numeric indexes in arbitrary order).
For example <code>&lt;docker.links.1&gt;db&lt;/docker.links.1&gt;</code> specifies a link
to the image with alias &apos;db&apos;.</li>
<li><strong>docker.memory</strong> Container memory (in bytes)</li>
<li><strong>docker.memorySwap</strong> Total memory (swap + memory) <code>-1</code> to disable swap</li>
<li><strong>docker.name</strong> Image name</li>
<li><strong>docker.namingStrategy</strong> Container naming (either <code>none</code> or <code>alias</code>)</li>
<li><strong>docker.portPropertyFile</strong> specifies a path to a port mapping used
when starting a container.</li>
<li><strong>docker.ports.idx</strong> Sets a port mapping. For example
<code>&lt;docker.ports.1&gt;jolokia.ports:8080&lt;docker.ports.1&gt;</code> maps
the container port 8080 dynamically to a host port and assigns this
host port to the Maven property <code>${jolokia.port}</code>. See
<a href="#port-mapping">Port mapping</a> for possible mapping options. When creating images images only
the right most port is used for exposing the port. For providing multiple port mappings,
the index should be count up. </li>
<li><strong>docker.registry</strong> Registry to use for pushing images.</li>
<li><strong>docker.restartPolicy.name</strong> Container restart policy</li>
<li><strong>docker.restartPolicy.retry</strong> Max restrart retries if <code>on-failure</code> used</li>
<li><strong>docker.user</strong> Container user</li>
<li><strong>docker.volumes.idx</strong> defines a list of volumes to expose when building an image</li>
<li><strong>docker.tags.idx</strong> defines a list of tags to apply to a built image</li>
<li><strong>docker.maintainer</strong> defines the maintainer&apos;s email as used when building an image</li>
<li><strong>docker.volumesFrom.idx</strong> defines a list of image aliases from which
the volumes should be mounted of the container. The list semantics
is the same as for links (see above). For examples
<code>&lt;docker.volumesFrom.1&gt;data&lt;/docker.volumesFrom.1&gt;</code> will mount all
volumes exported by the <code>data</code> image.</li>
<li><strong>docker.wait.http.url</strong> URL to wait for during startup of a container</li>
<li><strong>docker.wait.http.method</strong> HTTP method to use for ping check</li>
<li><strong>docker.wait.http.status</strong> Status code to wait for when doing HTTP ping check</li>
<li><strong>docker.wait.time</strong> Amount of time to wait during startup of a
  container (in ms)</li>
<li><strong>docker.wait.log</strong> Wait for a log output to appear.</li>
<li><strong>wait.exec.postStart</strong> Command to execute after the container has start up. </li>
<li><strong>wait.exec.preStop</strong> Command to execute before command stops.</li>
<li><strong>docker.wait.shutdown</strong> Time in milliseconds to wait between stopping a container and removing it.</li>
<li><strong>docker.wait.kill</strong> Time in milliseconds to wait between sending SIGTERM and SIGKILL to a container when stopping it.</li>
<li><strong>docker.workingDir</strong> Working dir for commands to run in</li>
</ul>
<p>Any other <code>&lt;run&gt;</code> or <code>&lt;build&gt;</code> sections are ignored when this handler
is used. Multiple property configuration handlers can be used if they
use different prefixes. As stated above the environment and ports
configuration are both used for running container and building
images. If you need a separate configuration you should use explicit
run and build configuration sections.</p>
<p>Example:</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">properties</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">docker.name</span>&gt;</span>jolokia/demo<span class="hljs-tag">&lt;/<span class="hljs-title">docker.name</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">docker.alias</span>&gt;</span>service<span class="hljs-tag">&lt;/<span class="hljs-title">docker.alias</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">docker.from</span>&gt;</span>consol/tomcat:7.0<span class="hljs-tag">&lt;/<span class="hljs-title">docker.from</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">docker.assembly.descriptor</span>&gt;</span>src/main/docker-assembly.xml<span class="hljs-tag">&lt;/<span class="hljs-title">docker.assembly.descriptor</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">docker.env.CATALINA_OPTS</span>&gt;</span>-Xmx32m<span class="hljs-tag">&lt;/<span class="hljs-title">docker.env.CATALINA_OPTS</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">docker.label.version</span>&gt;</span>${project.version}<span class="hljs-tag">&lt;/<span class="hljs-title">docker.label.version</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">docker.ports.jolokia.port</span>&gt;</span>8080<span class="hljs-tag">&lt;/<span class="hljs-title">docker.ports.jolokia.port</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">docker.wait.url</span>&gt;</span>http://localhost:${jolokia.port}/jolokia<span class="hljs-tag">&lt;/<span class="hljs-title">docker.wait.url</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">properties</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">build</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">plugins</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">plugin</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.jolokia<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>docker-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">configuration</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">images</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">image</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">external</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-title">type</span>&gt;</span>props<span class="hljs-tag">&lt;/<span class="hljs-title">type</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-title">prefix</span>&gt;</span>docker<span class="hljs-tag">&lt;/<span class="hljs-title">prefix</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">external</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-title">image</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">images</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">plugin</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">plugins</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">build</span>&gt;</span>
</code></pre>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./docker-logs.html" class="navigation navigation-prev " aria-label="Previous page: docker:logs"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./registry-handling.html" class="navigation navigation-next " aria-label="Next page: Registry Handling"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

    
    <script src="gitbook/plugins/gitbook-plugin-edit-link/plugin.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-code_tomorrow_scheme/code-tomorrow-scheme.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-code_tomorrow_scheme/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2},"edit-link":{"base":"https://github.com/rhuss/docker-maven-plugin/edit/master/doc/manual","label":"Edit This Page"}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
