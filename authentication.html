<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Authentication | docker-maven-plugin</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-anchors/plugin.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-code_tomorrow_scheme/code-tomorrow-scheme.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="./links.html" />
    
    
    <link rel="prev" href="./registry-handling.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="7"
        data-chapter-title="Authentication"
        data-filepath="authentication.md"
        data-basepath="."
        data-revision="Wed Jan 27 2016 11:40:27 GMT+0000 (UTC)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="installation.html">
            
                
                    <a href="./installation.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Installation
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="global-configuration.html">
            
                
                    <a href="./global-configuration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Global Configuration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="image-configuration.html">
            
                
                    <a href="./image-configuration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Image Configuration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="goals.html">
            
                
                    <a href="./goals.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Maven Goals
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="docker-build.html">
            
                
                    <a href="./docker-build.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        docker:build
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="docker-start.html">
            
                
                    <a href="./docker-start.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        docker:start
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="docker-stop.html">
            
                
                    <a href="./docker-stop.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                        docker:stop
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="docker-watch.html">
            
                
                    <a href="./docker-watch.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                        docker:watch
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="docker-push.html">
            
                
                    <a href="./docker-push.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                        docker:push
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="docker-remove.html">
            
                
                    <a href="./docker-remove.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.6.</b>
                        
                        docker:remove
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.7" data-path="docker-logs.html">
            
                
                    <a href="./docker-logs.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.7.</b>
                        
                        docker:logs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.8" data-path="docker-source.html">
            
                
                    <a href="./docker-source.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.8.</b>
                        
                        docker:source
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="external-configuration.html">
            
                
                    <a href="./external-configuration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        External Configuration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6" data-path="registry-handling.html">
            
                
                    <a href="./registry-handling.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        Registry Handling
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="7" data-path="authentication.html">
            
                
                    <a href="./authentication.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        Authentication
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="links.html">
            
                
                    <a href="./links.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        Further Reading
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >docker-maven-plugin</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h2 id="authentication"><a name="authentication" class="plugin-anchor" href="#authentication"><span class="fa fa-link"></span></a>Authentication</h2>
<p>When pulling (via the <code>autoPull</code> mode of <code>docker:start</code>) or pushing image, it
might be necessary to authenticate against a Docker registry.</p>
<p>There are three different ways for providing credentials:</p>
<ul>
<li>Using a <code>&lt;authConfig&gt;</code> section in the plugin configuration with
<code>&lt;username&gt;</code> and <code>&lt;password&gt;</code> elements. </li>
<li>Providing system properties <code>docker.username</code> and <code>docker.password</code>
from the outside </li>
<li>Using a <code>&lt;server&gt;</code> configuration in <code>~/.m2/settings.xml</code></li>
<li>Login into a registry with <code>docker login</code></li>
</ul>
<p>Using the username and password directly in the <code>pom.xml</code> is not
recommended since this is widely visible. This is most easiest and
transparent way, though. Using an <code>&lt;authConfig&gt;</code> is straight forward:</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">plugin</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">image</span>&gt;</span>consol/tomcat-7.0<span class="hljs-tag">&lt;/<span class="hljs-title">image</span>&gt;</span>
    ...
    <span class="hljs-tag">&lt;<span class="hljs-title">authConfig</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">username</span>&gt;</span>jolokia<span class="hljs-tag">&lt;/<span class="hljs-title">username</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">password</span>&gt;</span>s!cr!t<span class="hljs-tag">&lt;/<span class="hljs-title">password</span>&gt;</span>      
    <span class="hljs-tag">&lt;/<span class="hljs-title">authConfig</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">configuration</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">plugin</span>&gt;</span>
</code></pre>
<p>The system property provided credentials are a good compromise when
using CI servers like Jenkins. You simply provide the credentials from
the outside:</p>
<pre><code>mvn -Ddocker.username=jolokia -Ddocker.password=s!cr!t docker:push
</code></pre><p>The most secure and also the most <em>mavenish</em> way is to add a server to
the Maven settings file <code>~/.m2/settings.xml</code>:</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">servers</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">server</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">id</span>&gt;</span>docker.io<span class="hljs-tag">&lt;/<span class="hljs-title">id</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">username</span>&gt;</span>jolokia<span class="hljs-tag">&lt;/<span class="hljs-title">username</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">password</span>&gt;</span>s!cr!t<span class="hljs-tag">&lt;/<span class="hljs-title">password</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">server</span>&gt;</span>
  ....
<span class="hljs-tag">&lt;/<span class="hljs-title">servers</span>&gt;</span>
</code></pre>
<p>The server id must specify the registry to push to/pull from, which by
default is central index <code>docker.io</code> (or <code>index.docker.io</code> / <code>registry.hub.docker.com</code> as fallbacks). 
Here you should add your docker.io account for your repositories. If you have multiple accounts 
for the same registry, the second user can be specified as part of the ID. In the example above, if you 
have a second accorunt &apos;rhuss&apos; then use an <code>&lt;id&gt;docker.io/rhuss&lt;/id&gt;</code> for this second entry. I.e. add the 
username with a slash to the id name. The default without username is only taken if no server entry with 
a username appended id is chosen.</p>
<p>As a final fallback, this plugin consults <code>~/.docker/config.json</code> for getting to the credentials. Within this 
file credentials are stored when connecting to a registry with the command <code>docker login</code> from the command line. </p>
<h4 id="pull-vs-push-authentication"><a name="pull-vs-push-authentication" class="plugin-anchor" href="#pull-vs-push-authentication"><span class="fa fa-link"></span></a>Pull vs. Push Authentication</h4>
<p>The credentials lookup described above is valid for both push and
pull operations. In order to narrow things down, credentials can be be
provided for pull or push operations alone:</p>
<p>In an <code>&lt;authConfig&gt;</code> section a sub-section <code>&lt;pull&gt;</code> and/or <code>&lt;push&gt;</code>
can be added. In the example below the credentials provider are only
used for image push operations:</p>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">plugin</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">image</span>&gt;</span>consol/tomcat-7.0<span class="hljs-tag">&lt;/<span class="hljs-title">image</span>&gt;</span>
    ...
    <span class="hljs-tag">&lt;<span class="hljs-title">authConfig</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">push</span>&gt;</span>
         <span class="hljs-tag">&lt;<span class="hljs-title">username</span>&gt;</span>jolokia<span class="hljs-tag">&lt;/<span class="hljs-title">username</span>&gt;</span>
         <span class="hljs-tag">&lt;<span class="hljs-title">password</span>&gt;</span>s!cr!t<span class="hljs-tag">&lt;/<span class="hljs-title">password</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">push</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">authConfig</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">configuration</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">plugin</span>&gt;</span>
</code></pre>
<p>When the credentials are given on the command line as system
properties, then the properties <code>docker.pull.username</code> / 
<code>docker.pull.password</code> and <code>docker.push.username</code> /
<code>docker.push.password</code> are used for pull and push operations,
respectively (when given). Either way, the standard lookup algorithm
as described in the previous section is used as fallback. </p>
<h4 id="openshift-authentication"><a name="openshift-authentication" class="plugin-anchor" href="#openshift-authentication"><span class="fa fa-link"></span></a>OpenShift Authentication</h4>
<p>When working with the default registry in OpenShift, the credentials
to authtenticate are the OpenShift username and access token. So, a
typical interaction with the OpenShift registry from the outside is:</p>
<pre><code>oc login
...
mvn -Ddocker.registry=docker-registry.domain.com:80/default/myimage \
    -Ddocker.username=$(oc whoami) \
    -Ddocker.password=$(oc whoami -t)
</code></pre><p>(note, that the image&apos;s user name part (&quot;default&quot; here&quot;) must
correspond to an OpenShift project with the same name to which you
currently connected account has access).</p>
<p>This can be simplified by using the system property
<code>docker.useOpenShiftAuth</code> in which case the plugin does the
lookup. The equivalent to the example above is</p>
<pre><code>oc login
...
mvn -Ddocker.registry=docker-registry.domain.com:80/default/myimage \
    -Ddocker.useOpenShiftAuth
</code></pre><p>Alternatively the configuration option <code>&lt;useOpenShiftAuth&gt;</code> can be
added to the <code>&lt;authConfig&gt;</code> section. </p>
<p>For dedicted <em>pull</em> and <em>push</em> configuration the system properties
<code>docker.pull.useOpenShiftAuth</code> and <code>docker.push.useOpenShiftAuth</code> are
available as well as the configuration option <code>&lt;useOpenShiftAuth&gt;</code> in
an <code>&lt;pull&gt;</code> or <code>&lt;push&gt;</code> section within the <code>&lt;authConfig&gt;</code>
configuration. </p>
<h4 id="password-encryption"><a name="password-encryption" class="plugin-anchor" href="#password-encryption"><span class="fa fa-link"></span></a>Password encryption</h4>
<p>Regardless which mode you choose you can encrypt password as described
in the
<a href="http://maven.apache.org/guides/mini/guide-encryption.html" target="_blank">Maven documentation</a>. Assuming
that you have setup a <em>master password</em> in
<code>~/.m2/security-settings.xml</code> you can create easily encrypted
passwords:</p>
<pre><code class="lang-bash">$ mvn --encrypt-password
Password:
{QJ6wvuEfacMHklqsmrtrn1/ClOLqLm8hB7yUL23KOKo=}
</code></pre>
<p>This password then can be used in <code>authConfig</code>, <code>docker.password</code>
and/or the <code>&lt;server&gt;</code> setting configuration. However, putting an
encrypted password into <code>authConfig</code> in the <code>pom.xml</code> doesn&apos;t make
much sense, since this password is encrypted with an individual master
password.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./registry-handling.html" class="navigation navigation-prev " aria-label="Previous page: Registry Handling"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./links.html" class="navigation navigation-next " aria-label="Next page: Further Reading"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

    
    <script src="gitbook/plugins/gitbook-plugin-edit-link/plugin.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-code_tomorrow_scheme/code-tomorrow-scheme.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-code_tomorrow_scheme/plugin.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"edit-link":{"base":"https://github.com/rhuss/docker-maven-plugin/edit/master/doc/manual","label":"Edit This Page"},"anchors":{},"code_tomorrow_scheme":{},"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
